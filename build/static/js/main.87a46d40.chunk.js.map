{"version":3,"sources":["websocket/index.js","context/AppContext.js","components/Menu.js","components/WaitPage.js","components/Table.js","components/TrumpSymbol.js","lib/gameConfig.js","components/Card.js","components/DeckCards.js","lib/helpers.js","components/PlayerCards.js","components/TableCards.js","components/DiscardedCards.js","components/Cards.js","components/PassButton.js","components/Arrow.js","components/Timer.js","components/Filters.js","lib/GameState.js","lib/delayed-functions.js","components/App.js","serviceWorker.js","index.js"],"names":["websocket","client","connect","this","w3cwebsocket","listen","fn","onclose","onerror","error","onmessage","message","JSON","parse","data","send","messageObject","_this","stringify","readyState","OPEN","onopen","close","AppContext","React","createContext","MenuItemOption","props","changeItem","currOption","option","optionText","react_default","a","createElement","className","concat","onClick","style","cursor","Menu","username","mode","playersNumber","changeName","changeMode","isPlaying","changePlayersNumber","startGame","waitUsers","saveUserSettings","input","createRef","ref","type","value","onChange","e","target","current","placeholder","toUpperCase","slice","Menu_MenuItemOption","WaitPage","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","state","joinedUsers","userConfirms","allUsersConfirm","cancel","bind","assertThisInitialized","confirm","setState","startMultiplayGame","cancelWaiting","_this2","msgObj","updateJoinedUsers","groupSize","prevProps","isWaiting","connectToWebsocket","_this$props","_this$state","length","map","user","i","key","Component","Table","_ref","field","cx","width","cy","height","r","playerSpace","TrumpSymbol","placeCenter","cardSize","coords","x","y","context_AppContext","Consumer","_ref2","trumpSuit","href","transform","config","maxCardsAfterDealing","maxAttacks","Card","imageElement","id","rotation","side","activePlayer","_this$context","context","possibleCards","makeMove","cardStyles","updateCardStyles","movedCard","addMovedCard","removeMovedCard","gameConfig","translate","rotate","cardStyle","newStyle","transformOrigin","darker","includes","applyStyle","elem","transition","filter","changeStyles","window","requestAnimationFrame","setTimeout","onMouseOver","onMouseLeave","contextType","DeckCards","cards","react","card","shift","trump","objectSpread","components_Card","assign","components_TrumpSymbol","toRadian","angle","Math","PI","findRightTriangleSides","hypotenuse","cos","sin","getDeepCopy","obj","isArray","Array","newArray","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","entries","Symbol","iterator","next","done","_ref3","slicedToArray","err","return","newObj","prop","PlayerCards","players","playerCardsPosition","userIndex","allCards","playerIndex","_playerCardsPosition$","objectWithoutProperties","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","_ref6","_ref5","cardIndex","oneCardShift","relativeToPlaceCenter","helpers","push","TableCards","attacks","_ref4","attackIndex","attack","_ref7","attacking","DiscardedCards","Cards","placeCenters","deck","table","discarded","components_DeckCards","components_PlayerCards","fromCenterToPlayerCards","from","_","relativeToCenterCoords","findPlayerCardsPosition","components_TableCards","components_DiscardedCards","PassButton","show","text","opacity","Arrow","defenderIndex","playersCount","fromCenter","relativeToCenter","points","Timer","timer","Filters","values","GameState","attacker","defender","defendSucceed","activePlayers","observable","subscriber","subscribe","update","updates","deckCards","shuffleCards","genCards","playerCards","ranks","suits","n","rank","suit","cardsCopy","j","floor","random","tmp","dealCards","chooseTrump","clearGameProps","dealerIndex","getNextIndex","index","dealOneCard","randomIndex","sortPlayerCards","pop","isTrump","sort","b","card1","card2","getNumberOfActivePlayers","endGame","updateActivePlayers","updateAttackerAndDefender","updateMaxAttacks","sendPossibleCardsToUser","decision","makeDecision","updateActivePlayerTimers","playerObject","pass","rejected","gameState","isPlayerInGame","nextIndex","indexes","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","playersDontHaveTimers","userPass","defineAttackerAndDefenderByLowestTrump","minTrump","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","min","findPossibleCards","findCardsForDefend","findCardsForAttack","tableCards","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_step6","_iterator6","apply","toConsumableArray","tableCardRanks","_this3","notBeatenAttacks","_iteratorNormalCompletion7","_didIteratorError7","_iteratorError7","_step7","_loop","attackCard","getHigherCard","forEach","_iterator7","isDefender","isAttackRequired","cardsInDeck","unbeatenCards","cardId","getCardById","addCardToTable","playerCard","defendCard","_this4","attackIndexes","place","_iteratorNormalCompletion8","_didIteratorError8","_iteratorError8","_step8","_iterator8","_iteratorNormalCompletion9","_didIteratorError9","_iteratorError9","_step9","_iterator9","_this5","isUserInGame","userHasNoPossibleCards","_iteratorNormalCompletion10","_didIteratorError10","_iteratorError10","_step10","_loop2","randomTime","_playerObject$rejecte","_iterator10","endTrick","reduce","bool","clearTable","drawCardsFromDeck","_this6","discardedCards","_iteratorNormalCompletion11","_didIteratorError11","_iteratorError11","_step11","_iterator11","_iteratorNormalCompletion12","_didIteratorError12","_iteratorError12","_step12","_iterator12","_this7","playersDrawnCards","changePlayers","newCards","playerHasCards","cardsNeeded","lastDeckCard","loser","_iteratorNormalCompletion13","_didIteratorError13","_iteratorError13","_step13","_iterator13","_ref9","_ref8","delayed_functions","functions","delaying","add","run","App","viewport","showButton","timeout","handleStateUpdate","updateViewport","reduceTimer","settingsString","localStorage","getItem","settings","setItem","name","number","delayedFunctions","defineProperty","html","document","documentElement","clientWidth","clientHeight","throttled","addEventListener","removeEventListener","updateObject","unsubscribe","addObserver","genPlayers","initNewGame","makeUserMove","prevState","prevAttacks","currAttacks","prevTrump","currTrump","startTrick","prevPossibleCards","_this$state2","skip","clearTimeout","getUserSettings","removeListener","addResizeListener","handleStartTrick","handleShowButton","handleEndGame","handleTimerUpdate","svg","aspectRatio","scale","Provider","components_Menu","components_WaitPage","components_Table","components_Cards","components_PassButton","components_Arrow","components_Timer","components_Filters","Boolean","location","hostname","match","ReactDOM","render","components_App","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.87a46d40.chunk.js","sourcesContent":["import { w3cwebsocket } from 'websocket';\n\nconst websocket = {\n  client: null,\n  connect() {\n    if (!this.client) {\n      this.client = new w3cwebsocket('wss://durak-app.herokuapp.com/', 'echo-protocol');\n    }\n  },\n  listen(fn) {\n    this.client.onclose = () => fn('closed');\n    this.client.onerror = error => fn('error', error);\n    this.client.onmessage = message => \n      fn('message', JSON.parse(message.data));\n  },\n  send(messageObject) {\n    const message = JSON.stringify(messageObject);\n    if (this.client.readyState === this.client.OPEN) {\n      this.client.send(message);\n    } else {\n      this.client.onopen = () => this.client.send(message);\n    }\n  },\n  close() {\n    if (this.client) {\n      this.client.close();\n      this.client = null;\n    }\n  }\n};\n\nexport default websocket;","import React from 'react';\n\nconst AppContext = React.createContext();\n\nexport default AppContext;","import React from 'react';\nimport '../stylesheets/Menu.css';\n\nconst MenuItemOption = props => {\n  const { changeItem, currOption, option, optionText } = props;\n  return (\n    <span \n      className={`menu-item-option ${currOption === option ? 'current' : ''}`}\n      onClick={currOption !== option ? () => changeItem(option) : null}\n      style={{ cursor: currOption !== option ? 'pointer' : 'default' }}\n    >\n      {optionText}\n    </span>\n  );\n};\n\nconst Menu = props => {\n  const { username, mode, playersNumber, changeName, changeMode, isPlaying,\n          changePlayersNumber, startGame, waitUsers, saveUserSettings } = props;\n          \n  const input = React.createRef();\n\n  const handleInputChange = e => {\n    let { value } = e.target;\n    if (input.current.placeholder) input.current.placeholder = '';\n    if (value) value = value[0].toUpperCase() + value.slice(1);\n    changeName(value);\n  };\n\n\n  const handleSubmit = () => {\n    if (!username) {\n      input.current.placeholder = 'You should enter name';\n      return;\n    }\n    if (mode === 'single-player') {\n      saveUserSettings();\n      startGame();\n    } else {\n      saveUserSettings();\n      waitUsers();\n    }\n  };\n\n  return (\n    <div className={`menu ${isPlaying ? 'hide' : ''}`}>\n      <h1>Menu</h1>\n      <div className=\"menu-items\">\n        <label className=\"menu-item\">\n          <span className=\"menu-item-name\">Enter Name:</span>\n          <input ref={input} type=\"text\" value={username} onChange={handleInputChange} />\n        </label>\n        <div className=\"menu-item\">\n          <span className=\"menu-item-name\">Choose Mode:</span>\n          <MenuItemOption \n            changeItem={changeMode} currOption={mode} \n            option=\"single-player\" optionText=\"Single Player\"\n          />\n          <MenuItemOption \n            changeItem={changeMode} currOption={mode}\n            option=\"multiplayer\" optionText=\"Multiplayer\"\n          />\n        </div>\n        <div className=\"menu-item\">\n          <span className=\"menu-item-name\">Choose Players Number:</span>\n          <MenuItemOption \n            changeItem={changePlayersNumber} currOption={playersNumber} \n            option={2} optionText=\"2\"\n          />\n          <MenuItemOption \n            changeItem={changePlayersNumber} currOption={playersNumber} \n            option={3} optionText=\"3\"\n          />\n          <MenuItemOption \n            changeItem={changePlayersNumber} currOption={playersNumber} \n            option={4} optionText=\"4\"\n          />\n          <MenuItemOption \n            changeItem={changePlayersNumber} currOption={playersNumber} \n            option={5} optionText=\"5\"\n          />\n          <MenuItemOption \n            changeItem={changePlayersNumber} currOption={playersNumber} \n            option={6} optionText=\"6\"\n          />\n        </div>\n      </div>\n      <button onClick={handleSubmit} >\n        {mode === 'single-player' ? 'Play' : 'Wait for Users'}\n      </button>\n    </div>\n  )\n};\n\nexport default Menu;","import React, { Component } from 'react';\nimport websocket from '../websocket';\nimport '../stylesheets/WaitPage.css';\n\nclass WaitPage extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      joinedUsers: [],\n      userConfirms: false,\n      allUsersConfirm: false\n    };\n\n    this.cancel = this.cancel.bind(this);\n    this.confirm = this.confirm.bind(this);\n  }\n\n  updateJoinedUsers(joinedUsers) {\n    this.setState({ joinedUsers, playersNumber: this.state.playersNumber });\n  }\n\n  confirm() {\n    this.setState({ userConfirms: true });\n    websocket.send({ type: 'confirm' });\n  }\n\n  allUsersConfirm() {\n    this.props.startMultiplayGame();\n  }\n\n  cancel() {\n    this.props.cancelWaiting();\n    websocket.close();\n  }\n\n  connectToWebsocket() {\n    websocket.connect();\n    websocket.listen((type, msgObj) => {\n      if (type === 'message') {\n        if (msgObj.type === 'joinedUsers') this.updateJoinedUsers(msgObj.data.joinedUsers);\n        if (msgObj.type === 'allUsersConfirm') this.allUsersConfirm();\n      }\n      if (type === 'closed') this.cancel();\n    });\n    websocket.send({ \n      type: 'addData',\n      username: this.props.username,\n      groupSize: this.props.playersNumber\n    });\n  }\n\n  componentDidUpdate(prevProps) {\n    if (!prevProps.isWaiting && !prevProps.isPlaying && this.props.isWaiting) {\n      this.connectToWebsocket();\n      this.setState({ joinedUsers: [], userConfirms: false, allUsersConfirm: false });\n    }\n  }\n\n  render() {\n    const { isWaiting, playersNumber } = this.props;\n    const { joinedUsers, userConfirms } = this.state;\n\n    return (\n      <div className={`wait-page ${!isWaiting ? 'hide' : ''}`}>\n        <h1>Wait for Users</h1>\n        <div className=\"info\">\n          {!!joinedUsers.length && \n            <p><b>Joined Users: </b>\n              {joinedUsers.map((user, i) => \n                <span key={i}>{i ? ', ' + user : ' ' + user}</span>)}\n            </p>\n          }\n          <p><b>Remains to wait:</b> {playersNumber - joinedUsers.length}</p>\n          {userConfirms && <p>Waiting for Users to Confirm</p>}\n        </div>\n        <div className=\"buttons\">\n          <button className=\"cancel-button\" onClick={this.cancel}>Cancel</button>\n          {\n            joinedUsers.length === playersNumber && !userConfirms &&\n            <button className=\"confirm-button\" onClick={this.confirm}>Confirm</button>\n          }\n        </div>\n      </div>\n    );\n  }\n}\n\nexport default WaitPage;","import React from 'react';\nimport '../stylesheets/Table.css';\n\nconst Table = ({field}) => {\n  const style = {\n    cx: field.width / 2 + 'px',\n    cy: field.height / 2 + 'px',\n    r: (field.width - field.playerSpace * 2) / 2 + 'px'\n  };\n  return <circle className=\"table\" style={style} />;\n};\n\nexport default Table;\n","import React from 'react';\nimport AppContext from '../context/AppContext';\n\nconst TrumpSymbol = ({ placeCenter }) => {\n  const cardSize = {\n    width: 50,\n    height: 77.78\n  };\n\n  const coords = {\n    x: placeCenter.x - cardSize.width / 2,\n    y: placeCenter.y - cardSize.height / 2\n  };\n  \n  return (\n    <AppContext.Consumer>\n      {\n        ({trumpSuit}) => {\n          if (trumpSuit) {\n            return (\n              <image\n                x={0}\n                y={0}\n                width={cardSize.width}\n                height={cardSize.height}\n                href={`/images/card-suits/${trumpSuit}.svg`}\n                style={{transform: `translate(${coords.x}px, ${coords.y}px)`}}\n              />\n            );\n          } else return null\n        }\n      }\n    </AppContext.Consumer>\n  );\n};\n\nexport default TrumpSymbol;","const config = {\n  cardSize: {\n    width: 50,\n    height: 77.78\n  },\n  maxCardsAfterDealing: 6,\n  maxAttacks: 6\n};\n\nexport default config;\n","import React, { Component } from 'react';\nimport AppContext from '../context/AppContext';\nimport gameConfig from '../lib/gameConfig';\n\nclass Card extends Component {\n  constructor(props) {\n    super(props);\n    this.imageElement = React.createRef();\n  }\n\n  render() {\n    const { id, rotation, coords, side, activePlayer } = this.props;\n    const { possibleCards, makeMove, cardStyles, \n            updateCardStyles, movedCard, addMovedCard, removeMovedCard } = this.context;\n    const { imageElement } = this;\n    const { cardSize } = gameConfig;\n\n    const x = coords.x - cardSize.width / 2;\n    let y = coords.y - cardSize.height / 2;\n    if (activePlayer && movedCard === id) y -= 20;\n    const translate = `translate(${x}px, ${y}px)`;\n    const rotate = `rotate(${rotation ? rotation + 'deg' : '0deg'})`;\n    const cardStyle = cardStyles ? cardStyles[id] : null;\n    const newStyle = {\n      transformOrigin: `${coords.x}px ${coords.y}px`,\n      transform: `${rotate} ${translate}`\n    };\n\n    const darker = activePlayer && !possibleCards.includes(id);\n  \n    const applyStyle = (elem, style, transition) => {\n      elem.style.transform = style.transform;\n      elem.style.transformOrigin = style.transformOrigin;\n      elem.style.transition = transition ? '0.3s' : '0s';\n      elem.style.cursor = activePlayer && !darker ? 'pointer' : 'auto';\n      elem.style.filter = darker ? 'url(\"#darker\")' : 'none';\n    };\n\n  \n    (function changeStyles() {\n      window.requestAnimationFrame(() => {\n        const elem = imageElement.current;\n        if (!elem) changeStyles();\n        else {\n          if (cardStyle) {\n            applyStyle(elem, cardStyle, false);\n            window.requestAnimationFrame(() => {\n              applyStyle(elem, newStyle, true);\n              updateCardStyles(id, newStyle);\n            });\n          } else {\n            applyStyle(elem, newStyle, false);\n            updateCardStyles(id, newStyle);\n          }\n        }\n      });\n    })();\n\n    const moveCardUp = () => {\n      if (!movedCard && activePlayer && !darker) addMovedCard(id);\n    };\n\n    const moveCardDown = () => {\n      if (movedCard === id) removeMovedCard();\n    };\n  \n    const onClick = () => {\n      if (activePlayer && !darker) {\n        makeMove(id);\n        if (movedCard === id) setTimeout(removeMovedCard, 300);\n      }\n    };\n  \n    return (\n      <image\n        ref={this.imageElement}\n        x={0}\n        y={0}\n        width={cardSize.width}\n        height={cardSize.height}\n        href={side === 'front' ?\n          `/images/cards/${id}.png` :\n          `/images/cards/back.png`\n        }\n        id={id}\n        className=\"card\"\n        onClick={onClick}\n        onMouseOver={moveCardUp}\n        onMouseLeave={moveCardDown}\n      />\n    );\n  }\n}\n\nCard.contextType = AppContext;\n\nexport default Card;\n","import React, { Fragment } from 'react';\nimport TrumpSymbol from './TrumpSymbol';\nimport Card from './Card';\n\nconst DeckCards = props => {\n  const { cards, placeCenter } = props;\n  \n  const addProps = (card, i) => {\n    const shift = {\n      x: i * 0.1 + (card.trump ? -19 : 0),\n      y: -i * 0.1 + (card.trump ? 13 : 0)\n    };\n    const coords = {\n      x: placeCenter.x + shift.x,\n      y: placeCenter.y + shift.y\n    };\n    const rotation = card.trump ? 90 : 0;\n    return {\n      ...card,\n      coords,\n      rotation,\n      side: card.trump ? 'front' : 'back'\n    };\n  };\n\n  return (\n    <Fragment>\n      {\n        cards.length ?\n          cards.map(addProps).map(card => <Card {...card} key={card.id} />) :\n          <TrumpSymbol placeCenter={placeCenter} />\n      }\n    </Fragment>\n  );\n};\n\nexport default DeckCards;\n","const toRadian = angle => angle * Math.PI / 180;\n\nexport const findRightTriangleSides = (angle, hypotenuse) => {\n  return {\n    x: Math.cos(toRadian(angle)) * hypotenuse,\n    y: Math.sin(toRadian(angle)) * hypotenuse\n  };\n};\n\nexport const getDeepCopy = obj => {\n  const isArray = obj instanceof Array;\n  const isObj = typeof obj === 'object' && !isArray;\n  if (!isArray && !isObj) return obj;\n  if (isArray) {\n    const newArray = [];\n    for (const [i, elem] of obj.entries()) {\n      newArray[i] = getDeepCopy(elem);\n    }\n    return newArray;\n  } \n  // It is object\n  const newObj = {};\n  for (const prop in obj) {\n    newObj[prop] = getDeepCopy(obj[prop]);\n  }\n  return newObj;\n};\n\nexport const getFieldProps = viewport => {\n  const svg = {\n    ...viewport,\n    aspectRatio: viewport.width / viewport.height\n  };\n\n  const field = {\n    width: 700,\n    height: 600,\n    playerSpace: 150,\n    aspectRatio: 700 / 600\n  };\n\n  if (svg.aspectRatio > field.aspectRatio) {\n    field.scale = svg.height / field.height;\n    field.x = (svg.width - (field.width * field.scale)) / 2;\n    field.y = 0;\n  } else {\n    field.scale = svg.width / field.width;\n    field.x = 0;\n    field.y = (svg.height - (field.height * field.scale)) / 2;\n  }\n\n  field.style = {\n    transform: `translate(${field.x}px, ${field.y}px) scale(${field.scale})`\n  };\n\n  return field;\n};","import React, { Fragment } from 'react';\nimport Card from './Card';\nimport * as helpers from '../lib/helpers';\n\nconst PlayerCards = props => {\n  const { players, playerCardsPosition, userIndex } = props;\n  const allCards = [];\n\n  for (const [playerIndex, cards] of players.entries()) {\n    const { angle, ...placeCenter } = playerCardsPosition[playerIndex];\n    for (const [cardIndex, card] of cards.entries()) {\n      const oneCardShift = playerIndex === userIndex ? 20 : 5;\n      const shift = (cardIndex - (cards.length - 1) / 2) * oneCardShift;\n      const relativeToPlaceCenter = helpers.findRightTriangleSides(\n        angle,\n        shift\n      );\n      const coords = {\n        x: placeCenter.x + relativeToPlaceCenter.x,\n        y: placeCenter.y + relativeToPlaceCenter.y\n      };\n\n      allCards.push({\n        ...card,\n        rotation: angle,\n        coords,\n        side: playerIndex === userIndex ? 'front' : 'back',\n        activePlayer: playerIndex === userIndex\n      });\n    }\n  }\n\n  return (\n    <Fragment>\n      {allCards.map(card =>  <Card { ...card } key={card.id} />)}\n    </Fragment>\n  );\n};\n\nexport default PlayerCards;\n","import React, { Fragment } from 'react';\nimport Card from './Card';\n\nconst TableCards = ({ attacks, placeCenter }) => {\n  const allCards = [];\n  for (const [attackIndex, attack] of attacks.entries()) {\n    for (const [cardIndex, card] of attack.entries()) {\n      const attacking = cardIndex === 0;\n      const shift = {};\n      if (attacks.length > 3) {\n        if (attackIndex > 2) {\n          shift.x = attackIndex - 3 - (attacks.length - 4) / 2;\n          shift.y = 1;\n        } else {\n          shift.x = attackIndex - 1;\n          shift.y = -1;\n        }\n      } else {\n        shift.x = attackIndex - (attacks.length - 1) / 2;\n        shift.y = 0;\n      }\n\n      if (!attacking) {\n        shift.x += 0.05;\n        shift.y += 0.4;\n      }\n\n      shift.x = shift.x * 70;\n      shift.y = shift.y * 60;\n\n      const coords = {\n        x: placeCenter.x + shift.x,\n        y: placeCenter.y + shift.y\n      };\n\n      allCards.push({ ...card, coords, side: 'front' });\n    }\n  }\n\n  return (\n    <Fragment>\n      {allCards.map(card => <Card { ...card } key={card.id} />)}\n    </Fragment>\n  );\n};\n\nexport default TableCards;\n","import React, { Fragment } from 'react';\nimport Card from './Card';\n\nconst DiscardedCards = ({ cards, placeCenter }) => (\n  <Fragment>\n    {cards.map(card => \n      <Card {...card} key={card.id} coords={ {...placeCenter} } side= 'back' />\n    )}\n  </Fragment>\n);\n\nexport default DiscardedCards;\n","import React, { Fragment } from 'react';\nimport DeckCards from './DeckCards';\nimport PlayerCards from './PlayerCards';\nimport TableCards from './TableCards';\nimport DiscardedCards from './DiscardedCards';\nimport * as helpers from '../lib/helpers';\n\nconst Cards = props => {\n  const { cards, field, players, userIndex } = props;\n  const findPlayerCardsPosition = () => {\n    const avgSide = (field.width + field.height) / 2;\n    const fromCenterToPlayerCards = avgSide / 2 - field.playerSpace / 2;\n\n    return Array.from(\n      { length: players.length },\n      (_, i) => {\n        const angle = (i - userIndex) * 360 / players.length;\n        const relativeToCenterCoords = helpers.findRightTriangleSides(\n          angle + 90,\n          fromCenterToPlayerCards\n        );\n        return {\n          angle,\n          x: field.width / 2 + relativeToCenterCoords.x,\n          y: field.height / 2 + relativeToCenterCoords.y\n        };\n      }\n    );\n  };\n\n  const placeCenters = {\n    deck: {\n      x: field.width * 0.36,\n      y: field.height * 0.5\n    },\n    table: {\n      x: field.width * 0.55,\n      y: field.height * 0.48\n    },\n    discarded: {\n      x: field.width * 1.7,\n      y: field.height * 0.5\n    }\n  };\n\n  return (\n    <Fragment>\n      <DeckCards cards={cards.deck} placeCenter={placeCenters.deck} />\n      <PlayerCards \n        players={cards.players} \n        playerCardsPosition={findPlayerCardsPosition()} \n        userIndex={userIndex}\n      />\n      <TableCards attacks={cards.table} placeCenter={placeCenters.table} />\n      <DiscardedCards cards={cards.discarded} placeCenter={placeCenters.discarded} />\n    </Fragment>\n  );\n};\n\nexport default Cards;\n","import React from 'react';\nimport '../stylesheets/PassButton.css';\n\nconst PassButton = ({show, text, onClick}) => {\n  const style = {\n    opacity: show ? 1 : 0,\n    cursor: show ? 'pointer' : 'default'\n  };\n\n\n  return (\n    <g\n      className=\"pass-button\"\n      style={style}\n      onClick={onClick}\n    >\n      <rect />\n      <text>{text}</text>\n    </g>\n  );\n};\n\nexport default PassButton;\n","import React from 'react';\nimport * as helpers from '../lib/helpers';\nimport '../stylesheets/Arrow.css';\n\nconst Arrow = ({field, defenderIndex, playersCount, userIndex}) => {\n\tif (defenderIndex === null) return null;\n\tconst angle = (defenderIndex - userIndex) * 360 / playersCount;\n\tconst fromCenter = (field.width - field.playerSpace * 2) / 2 - 35;\n\tconst relativeToCenter = helpers.findRightTriangleSides(\n\t\tangle + 95,\n\t\tfromCenter\n\t);\n\tconst x = field.width / 2 + relativeToCenter.x;\n\tconst y = field.height / 2 + relativeToCenter.y;\n\n\tconst style = {\n\t\ttransform: `rotate(${angle}deg) translate(${x}px, ${y}px)`,\n\t\ttransformOrigin: `${x}px ${y}px`\n\t};\n\n\treturn (\n\t\t<polygon className=\"arrow\" points=\"0,0 28,0 14,28\" x={0} y={0} style={style} />\n\t)\n};\n\nexport default Arrow;","import React from 'react';\nimport '../stylesheets/Timer.css'\n\nconst Timer = ({ timer }) => {\n  if (timer === null) return null;\n\n  return (\n    <g className=\"timer\" >\n      <rect />\n      <text>{timer}</text>\n    </g>\n  );\n  \n};\n\nexport default Timer;","import React from 'react';\n\nconst Filters = () => {\n  return (\n    <defs>\n      <filter id=\"darker\">\n        <feColorMatrix\n          type=\"matrix\"\n          values=\".6   0   0   0   0\n                  0  .6   0   0   0\n                  0   0  .6   0   0\n                  0   0   0   1   0 \"/>\n      </filter>\n    </defs>\n  );\n};\n\nexport default Filters;\n","import config from './gameConfig';\nimport * as helpers from './helpers';\n\nclass GameState {\n  constructor(mode) {\n    this.cards = {\n      deck: [],\n      players: [],\n      table: [],\n      discarded: []\n    };\n    this.userIndex = 0;\n    this.trumpSuit = null;\n    this.attacker = null;\n    this.defender = null;\n    this.defendSucceed = null;\n    this.activePlayers = {\n      players: []\n    };\n    this.maxAttacks = 0;\n    this.observable = {\n      subscriber: null,\n      subscribe(fn) {\n        this.subscriber = fn;\n        return () => this.subscriber = null;\n      },\n      update(updates) {\n        this.subscriber(updates);\n      }\n    };\n  }\n  initNewGame(playersNumber) {\n    const deckCards = this.shuffleCards(this.genCards());\n    const playerCards = Array.from({length: playersNumber}, () => ([]));\n    this.cards = {\n      ...this.cards,\n      deck: deckCards,\n      players: playerCards\n    };\n    this.observable.update([{ prop: 'cards', value: this.cards }]);\n  }\n  genCards() {\n    const ranks = [\n      '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'\n    ];\n    const values = [\n      2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14\n    ];\n    const suits = ['clubs', 'diamonds', 'hearts', 'spades'];\n    const cards = [];\n    for (let i = 0; i < ranks.length; i++) {\n      for (let n = 0; n < suits.length; n++) {\n        cards.push({\n          id: `${ranks[i]}-${suits[n]}`,\n          rank: ranks[i],\n          suit: suits[n],\n          value: values[i]\n        });\n      }\n    }\n\n    return cards;\n  }\n  shuffleCards(cards) {\n    const cardsCopy = helpers.getDeepCopy(cards);\n\n    for (let i = cardsCopy.length - 1; i > 0; i--) {\n      const j = Math.floor(Math.random() * (i + 1));\n      const tmp = helpers.getDeepCopy(cardsCopy[i]);\n      cardsCopy[i] = helpers.getDeepCopy(cardsCopy[j]);\n      cardsCopy[j] = helpers.getDeepCopy(tmp);\n    }\n\n    return cardsCopy;\n  }\n  startGame() {\n    this.dealCards();\n    this.chooseTrump();\n    this.clearGameProps();\n  }\n  dealCards() {\n    const dealerIndex = this.userIndex;\n    const playersNumber = this.cards.players.length;\n    const getNextIndex = index => index + 1 === playersNumber ? 0 : index + 1;\n    let index = getNextIndex(dealerIndex);\n    while(this.cards.players[index].length < config.maxCardsAfterDealing) {\n      this.dealOneCard(index);\n      this.observable.update([{ prop: 'cards', value: this.cards }]);\n      index = getNextIndex(index);\n    }\n  }\n  chooseTrump() {\n    const deckCards = helpers.getDeepCopy(this.cards.deck);\n    const randomIndex = Math.floor(Math.random() * deckCards.length);\n    const card = deckCards[randomIndex];\n    deckCards[randomIndex] = deckCards[0];\n    deckCards[0] = { ...card, trump: true };\n    this.cards = {\n      ...this.cards,\n      deck: deckCards\n    };\n    this.trumpSuit = card.suit;\n    this.sortPlayerCards();\n    this.observable.update([\n      { prop: 'cards', value: this.cards },\n      { prop: 'trumpSuit', value: this.trumpSuit }\n    ]);\n  }\n  dealOneCard(playerIndex) {\n    const deckCards = helpers.getDeepCopy(this.cards.deck);\n    const playerCards = helpers.getDeepCopy(this.cards.players);\n    const card = deckCards.pop();\n    playerCards[playerIndex].push(card);\n\n    this.cards = {\n      ...this.cards,\n      deck: deckCards,\n      players: playerCards\n    };\n    this.sortPlayerCards();\n  }\n  sortPlayerCards() {\n    const isTrump = card => card.suit === this.trumpSuit;\n    const isEqualSuit = (card1, card2) => {\n      if (!this.trumpSuit) return true;\n      if (isTrump(card1) && isTrump(card2)) return true;\n      if (!isTrump(card1) && !isTrump(card2)) return true;\n      return false;\n    };\n\n    const playerCards = helpers.getDeepCopy(this.cards.players);\n    for (const cards of playerCards) {\n      cards.sort((a, b) => {\n        if (isEqualSuit(a, b)) return a.value - b.value;\n        if (isTrump(a) && !isTrump(b)) return 1;\n        if (!isTrump(a) && isTrump(b)) return -1;\n        return 0;\n      });\n    }\n\n    this.cards = {\n      ...this.cards,\n      players: playerCards\n    };\n  }\n  clearGameProps() {\n    this.defendSucceed = null;\n  }\n  startTrick() {\n    if (this.getNumberOfActivePlayers() < 2) this.endGame();\n    else {\n      this.updateActivePlayers();\n      this.updateAttackerAndDefender();\n      this.updateMaxAttacks();\n      if (this.attacker === this.userIndex) this.sendPossibleCardsToUser();\n      else {\n        const decision = this.makeDecision(this.attacker);\n        this.makeMove(this.attacker, decision);\n        this.updateActivePlayerTimers();\n      }\n    }\n  }\n  getNumberOfActivePlayers() {\n    return this.cards.players.filter(cards => cards.length).length;\n  }\n  updateActivePlayers() {\n    const activePlayers = [];\n    for (const [playerIndex, cards] of this.cards.players.entries()) {\n      if (cards.length) {\n        const playerObject = { index: playerIndex };\n        if (playerIndex === this.userIndex) playerObject.pass = false;\n        else {\n          playerObject.timer = null;\n          playerObject.rejected = [];\n        }\n        activePlayers.push(playerObject);\n      }\n    }\n    const gameState = this;\n    this.activePlayers = {\n      players: activePlayers,\n      isPlayerInGame(index) {\n        return !!this.players.filter(playerObject => playerObject.index === index)[0];\n      },\n      getNextIndex(index) {\n        const indexes = this.players.map(playerObject => playerObject.index);\n        let nextIndex;\n        for (const i of indexes) {\n          if (i > index) {\n            nextIndex = i;\n            break;\n          }\n        }\n        if (nextIndex === undefined) nextIndex = indexes[0];\n        return nextIndex;\n      },\n      playersDontHaveTimers() {\n        const playersWithTimers = this.players.filter(playerObject =>  playerObject.timer);\n        return !playersWithTimers.length;\n      },\n      userPass() {\n        this.players = this.players.map(playerObject => \n          playerObject.index === gameState.userIndex ? \n            ({ ...playerObject, pass: true }) : \n            playerObject)\n      }\n    };\n  }\n  updateAttackerAndDefender() {\n    if (this.defendSucceed === null) this.defineAttackerAndDefenderByLowestTrump();\n    else if (this.defendSucceed) {\n      if (this.activePlayers.isPlayerInGame(this.defender)) {\n        this.attacker = this.defender;\n      } else {\n        this.attacker = this.activePlayers.getNextIndex(this.defender);\n      }\n    } else {\n      this.attacker = this.activePlayers.getNextIndex(this.defender);\n    }\n\n    this.defender = this.activePlayers.getNextIndex(this.attacker);\n\n    this.observable.update([\n      { prop: 'attacker', value: this.attacker },\n      { prop: 'defender', value: this.defender }\n    ])\n  }\n  defineAttackerAndDefenderByLowestTrump() {\n    const playerCards = this.cards.players;\n    const playersNumber = playerCards.length;\n    let minTrump = {\n      playerIndex: null,\n      value: 15\n    };\n    for (const [index, cards] of playerCards.entries()) {\n      for (const card of cards) {\n        if (card.suit === this.trumpSuit && card.value < minTrump.value) {\n          minTrump = {\n            playerIndex: index,\n            value: card.value\n          };\n        }\n      }\n    }\n\n    if (minTrump.playerIndex !== null) {\n      this.attacker = minTrump.playerIndex;\n    } else {\n      const randomIndex = Math.floor(Math.random() * playersNumber);\n      this.attacker = randomIndex;\n    }\n    this.defender = this.activePlayers.getNextIndex(this.attacker);\n  }\n  updateMaxAttacks() {\n    this.maxAttacks = Math.min(\n      this.cards.players[this.defender].length,\n      config.maxAttacks\n    );\n  }\n  sendPossibleCardsToUser(possibleCards) {\n    if (!possibleCards) possibleCards = this.findPossibleCards(this.userIndex);\n    this.observable.update([{prop: 'possibleCards', value: possibleCards}]);\n  }\n  findPossibleCards(playerIndex) {\n    if (playerIndex === this.defender) return this.findCardsForDefend(playerIndex);\n    else return this.findCardsForAttack(playerIndex);\n  }\n  findCardsForAttack(playerIndex) {\n    const attacks = this.cards.table;\n    const playerCards = this.cards.players[playerIndex];\n    if (attacks.length >= this.maxAttacks) return [];\n    if (!attacks.length) return playerCards.map(card => card.id);\n\n    const tableCards = [];\n    for (const attack of attacks) {\n      tableCards.push(...attack);\n    }\n    const tableCardRanks = tableCards.map(card => card.rank);\n    return playerCards.filter(card => tableCardRanks.includes(card.rank))\n                      .map(card => card.id);\n  }\n  findCardsForDefend(playerIndex) {\n    const playerCards = this.cards.players[playerIndex];\n    const notBeatenAttacks = this.cards.table\n      .map((attack, index) => ({cards: attack, index}))\n      .filter(attack => {\n        if (attack.cards.length === 1) return true;\n        return false;\n      });\n    const possibleCards = [];\n    for (const attack of notBeatenAttacks) {\n      const attackCard = attack.cards[0];\n      playerCards.filter(card =>\n        this.getHigherCard(card, attackCard).id === card.id\n      ).forEach(card => {\n        if (!possibleCards.includes(card.id)) possibleCards.push(card.id);\n      });\n    }\n    return possibleCards;\n  }\n  makeDecision(playerIndex) {\n    const possibleCards = this.findPossibleCards(playerIndex);\n    if (possibleCards.length) {\n      const isDefender = this.defender === playerIndex;\n      const isAttackRequired = !this.cards.table.length;\n      const cardsInDeck = !!this.cards.deck.length;\n      const unbeatenCards = this.cards.table.filter(attack => attack.length === 1);\n      const cardId = possibleCards[0];\n      const card = this.getCardById(cardId);\n      let pass = false;\n\n      if (!isDefender) {\n        if (!isAttackRequired) {\n          if (cardsInDeck && card.suit === this.trumpSuit) pass = true;\n        }\n      } else {\n        if (possibleCards.length < unbeatenCards.length) pass = true;\n        if (cardsInDeck && card.suit === this.trumpSuit && card.value > 10) pass = true;\n      }\n\n      if (!pass) return cardId;\n      else return null;\n    } \n  }\n  makeMove(playerIndex, cardId) {\n    const isDefender = playerIndex === this.defender;\n    const card = this.getCardById(cardId);\n\n    const tableCards = this.addCardToTable(card, isDefender);\n\n    const playerCards = this.cards.players.map((cards, index) => {\n      if (index === playerIndex) {\n        return cards.filter(playerCard => playerCard.id !== cardId);\n      } else return cards;\n    });\n\n    this.cards = {\n      ...this.cards,\n      table: tableCards,\n      players: playerCards\n    };\n    this.observable.update([{ prop: 'cards', value: this.cards }]);\n  }\n  addCardToTable(card, defendCard) {\n    const tableCards = helpers.getDeepCopy(this.cards.table);\n    if (defendCard) {\n      let attackIndexes = [];\n      tableCards.forEach((attack, index) => {\n        if (attack.length === 1 &&\n            this.getHigherCard(card, attack[0]).id === card.id) {\n              attackIndexes.push(index);\n        }\n      });\n      const randomIndex = Math.floor(Math.random() * attackIndexes.length);\n      const attackIndex = attackIndexes[randomIndex];\n      return tableCards.map((attack, index) =>\n        index === attackIndex ? ([ ...attack, card ]) : attack\n      );\n    } \n    \n    return [ ...this.cards.table, [ card] ];\n  }\n  getCardById(id) {\n    for (const place in this.cards) {\n      for (const elem of this.cards[place]) {\n        if (elem instanceof Array) {\n          for (const card of elem) {\n            if (card.id === id) return card;\n          }\n        } else {\n          if (elem.id === id) return elem;\n        }\n      }\n    }\n  }\n  getHigherCard(a, b) {\n    if (a.suit === b.suit) {\n      if (a.value > b.value) return a;\n      else return b;\n    }\n    if (a.suit === this.trumpSuit) return a;\n    return b;\n  }\n  updateActivePlayerTimers() {\n    const isUserInGame = this.activePlayers.isPlayerInGame(this.userIndex);\n    let userHasNoPossibleCards = isUserInGame ? false : true;\n    for (const playerObject of this.activePlayers.players) {\n      if (playerObject.index === this.userIndex) {\n        if (playerObject.pass) userHasNoPossibleCards = true;\n        else {\n          const possibleCards = this.findPossibleCards(playerObject.index);\n          if (!possibleCards.length) userHasNoPossibleCards = true;\n          this.sendPossibleCardsToUser(possibleCards);\n        }\n      } else if (!playerObject.timer) {\n        const possibleCards = this.findPossibleCards(playerObject.index)\n          .filter(cardId => \n            !playerObject.rejected.includes(cardId));\n        \n        if (possibleCards.length) {\n          const randomTime = isUserInGame ? \n            Math.random() * 2000 + 2000 :\n            Math.random() * 1500 + 1500;\n          \n          playerObject.timer = setTimeout(\n            () => {\n              playerObject.timer = null;\n              const decision = this.makeDecision(playerObject.index);\n              if (decision) this.makeMove(playerObject.index, decision);\n              else playerObject.rejected.push(...possibleCards);\n\n              this.updateActivePlayerTimers();\n            }, randomTime);\n        }\n      }\n    }\n    if (this.activePlayers.playersDontHaveTimers() && userHasNoPossibleCards) {\n      this.endTrick();\n    }\n  }\n  endTrick() {\n    this.defendSucceed = this.cards.table.reduce((bool, attack) =>\n      attack.length === 1 ? false : bool, true);\n\n    this.clearTable();\n    this.drawCardsFromDeck();\n  }\n  clearTable() {\n    const playerCards = helpers.getDeepCopy(this.cards.players[this.defender]);\n    const discardedCards = helpers.getDeepCopy(this.cards.discarded);\n    for (const attack of this.cards.table) {\n      for (const card of attack) {\n        if (this.defendSucceed) discardedCards.push(card);\n        else playerCards.push(card);\n      }\n    }\n    this.cards = {\n      ...this.cards,\n      players: this.cards.players.map((cards, index) =>\n        index === this.defender ? playerCards : cards),\n      discarded: discardedCards,\n      table: []\n    };\n    this.sortPlayerCards();\n    this.observable.update([{ prop: 'cards', value: this.cards }]);\n  }\n  drawCardsFromDeck() {\n    const playersNumber = this.cards.players.length;\n    let playersDrawnCards = 0;\n    let index = this.attacker;\n    const changePlayers = (index, newCards) =>\n      this.cards.players.map((cards, i) => index === i ? newCards : cards);\n\n    while(playersDrawnCards < playersNumber) {\n      const playerHasCards = this.cards.players[index].length;\n      if (playerHasCards < config.maxCardsAfterDealing) {\n        const cardsNeeded = config.maxCardsAfterDealing - playerHasCards;\n        const playerCards = helpers.getDeepCopy(this.cards.players[index]);\n        const deckCards = helpers.getDeepCopy(this.cards.deck);\n\n        for (let i = 0; i < cardsNeeded; i++) {\n          if (deckCards.length) {\n            const lastDeckCard = deckCards.pop();\n            playerCards.push(lastDeckCard);\n          }\n        }\n\n        this.cards = {\n          ...this.cards,\n          players: changePlayers(index, playerCards),\n          deck: deckCards\n        };\n      }\n\n      this.sortPlayerCards();\n      this.observable.update([{ prop: 'cards', value: this.cards }]);\n      playersDrawnCards++;\n      index = index - 1;\n      if (index === -1) index = playersNumber - 1;\n    }\n  }\n  endGame() {\n    let loser = null;\n    for (const [playerIndex, cards] of this.cards.players.entries()) {\n      if (cards.length) {\n        loser = playerIndex;\n        break;\n      }\n    }\n    this.trumpSuit = null;\n    this.cards = {\n      deck: [],\n      players: [],\n      table: [],\n      discarded: []\n    };\n    this.observable.update([\n      { prop: 'isPlaying', value: false },\n      { prop: 'trumpSuit', value: null },\n      { prop: 'attacker', value: null },\n      { prop: 'defender', value: null },\n      { prop: 'loser', value: loser }\n    ]);\n  }\n  makeUserMove(cardId) {\n    const possibleCards = this.findPossibleCards(this.userIndex);\n    if (possibleCards.includes(cardId)) {\n      this.makeMove(this.userIndex, cardId);\n      this.updateActivePlayerTimers();\n    }\n  }\n  pass() {\n    this.activePlayers.userPass();\n    this.observable.update([{prop: 'possibleCards', value: []}])\n    this.updateActivePlayerTimers();\n  }\n};\n\nexport default GameState;","export default {\n  functions: [],\n  delaying: false,\n  add(fn) {\n    this.functions.push(fn);\n    this.run();\n  },\n  run() {\n    if (this.functions.length && !this.delaying) {\n      const fn = this.functions[0];\n      this.delaying = true;\n      setTimeout(() => {\n        fn();\n        this.functions.shift();\n        this.delaying = false;\n        this.run();\n      }, 200);\n    }\n  }\n};\n","import React, {Component} from 'react';\nimport websocket from '../websocket';\nimport AppContext from '../context/AppContext';\nimport Menu from './Menu';\nimport WaitPage from './WaitPage';\nimport Table from './Table';\nimport Cards from './Cards';\nimport PassButton from './PassButton';\nimport Arrow from './Arrow';\nimport Timer from './Timer';\nimport Filters from './Filters';\nimport GameState from '../lib/GameState';\nimport delayedFunctions from '../lib/delayed-functions';\nimport * as helpers from '../lib/helpers';\nimport '../stylesheets/App.css';\n\nclass App extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tviewport: {\n\t\t\t\twidth: 1024,\n\t\t\t\theight: 768\n\t\t\t},\n\t\t\tisPlaying: false,\n\t\t\tisWaiting: false,\n\t\t\tuserIndex: 0,\n\t\t\tusername: '',\n\t\t\tmode: 'single-player',\n\t\t\tplayersNumber: 2,\n\t\t\tplayers: [],\n\t\t\tcards: {\n\t\t\t\tdeck: [],\n\t\t\t\tplayers: [],\n\t\t\t\ttable: [],\n\t\t\t\tdiscarded: []\n\t\t\t},\n\t\t\tpossibleCards: [],\n\t\t\tattacker: null,\n\t\t\tdefender: null,\n\t\t\ttrumpSuit: null,\n\t\t\tloser: null,\n\t\t\tshowButton: false,\n\t\t\tmovedCard: null,\n\t\t\ttimer: null\n\t\t};\n\n\t\tthis.timeout = null;\n\t\tthis.gameState = null;\n\t\tthis.cardStyles = null;\n\t\tthis.handleStateUpdate = this.handleStateUpdate.bind(this);\n\t\tthis.updateViewport = this.updateViewport.bind(this);\n\t\tthis.startGame = this.startGame.bind(this);\n\t\tthis.makeMove = this.makeMove.bind(this);\n\t\tthis.pass = this.pass.bind(this);\n\t\tthis.updateCardStyles = this.updateCardStyles.bind(this);\n\t\tthis.addMovedCard = this.addMovedCard.bind(this);\n\t\tthis.removeMovedCard = this.removeMovedCard.bind(this);\n\t\tthis.changeName = this.changeName.bind(this);\n\t\tthis.changeMode = this.changeMode.bind(this);\n\t\tthis.changePlayersNumber = this.changePlayersNumber.bind(this);\n\t\tthis.saveUserSettings = this.saveUserSettings.bind(this);\n\t\tthis.waitUsers = this.waitUsers.bind(this);\n\t\tthis.cancelWaiting = this.cancelWaiting.bind(this);\n\t\tthis.startMultiplayGame = this.startMultiplayGame.bind(this);\n\t\tthis.reduceTimer = this.reduceTimer.bind(this);\n\t}\n\n\tgetUserSettings() {\n\t\tconst settingsString = localStorage.getItem('settings');\n\t\tif (settingsString) {\n\t\t\tconst settings = JSON.parse(settingsString);\n\t\t\tconst { username, mode, playersNumber } = settings;\n\t\t\tthis.setState({ username, mode, playersNumber });\n\t\t}\n\t}\n\n\tsaveUserSettings() {\n\t\tconst { username, mode, playersNumber } = this.state;\n\t\tconst settingsString = JSON.stringify({ username, mode, playersNumber });\n\t\tlocalStorage.setItem('settings', settingsString);\n\t}\n\n\tchangeName(name) {\n\t\tthis.setState({ username: name });\n\t}\n\n\tchangeMode(mode) {\n\t\tthis.setState({ mode });\n\t}\n\n\tchangePlayersNumber(number) {\n\t\tthis.setState({ playersNumber: number });\n\t}\n\n\twaitUsers() {\n\t\tthis.setState({ isWaiting: true });\n\t}\n\n\tcancelWaiting() {\n\t\tthis.setState({ isWaiting: false });\n\t}\n\n\tstartMultiplayGame() {\n\t\tthis.setState({ isWaiting: false, isPlaying: true });\n\t\twebsocket.listen((type, msgObj) => {\n\t\t\tif (type === 'message' && msgObj.type === 'gameStateUpdate') {\n\t\t\t\tdelayedFunctions.add(() => this.handleStateUpdate(msgObj.data.updates));\n\t\t\t}\n\t\t});\n\t}\n\n\taddObserver() {\n\t\treturn this.gameState.observable.subscribe(updates => {\n\t\t\tdelayedFunctions.add(() => this.handleStateUpdate(updates));\n\t\t});\n\t}\n\n\tupdateCardStyles(cardId, style) {\n\t\tthis.cardStyles = {\n\t\t\t...this.cardStyles,\n\t\t\t[cardId]: style\n\t\t};\n\t}\n\n\tupdateViewport() {\n\t\tconst html = document.documentElement;\n\t\tconst width = html.clientWidth;\n\t\tconst height = html.clientHeight;\n\t\tthis.setState({\n\t\t\tviewport: { width, height }\n\t\t});\n\t}\n\n\taddResizeListener() {\n\t\tlet throttled = false;\n\t\tconst fn = () => {\n\t\t\tif (!throttled) {\n\t\t\t\tthrottled = true;\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthrottled = false;\n\t\t\t\t\tthis.updateViewport();\n\t\t\t\t}, 300);\n\t\t\t}\n\t\t};\n\t\twindow.addEventListener('resize', fn);\n\t\treturn () => window.removeEventListener('resize', fn);\n\t}\n\n\tgenPlayers(playersNumber) {\n\t\tconst players = Array.from(\n\t\t\t{ length: playersNumber },\n\t\t\t(_, i) => ({ name: 'Player' + i })\n\t\t);\n\t\treturn players;\n\t}\n\n\thandleStateUpdate(updates) {\n\t\tconst updateObject = {};\n\t\tfor (let { prop, value } of updates) {\n\t\t\tupdateObject[prop] = value;\n\t\t}\n\n\t\tthis.setState(updateObject);\n\t}\n\n\taddMovedCard(cardId) {\n\t\tthis.setState({movedCard: cardId});\n\t}\n\n\tremoveMovedCard() {\n\t\tthis.setState({movedCard: null});\n\t}\n\n\tstartGame() {\n\t\tconst { playersNumber } = this.state;\n\t\tthis.gameState = new GameState();\n\t\tthis.unsubscribe = this.addObserver();\n\t\tthis.setState({ \n\t\t\tisPlaying: true,\n\t\t\tplayers: this.genPlayers(playersNumber)\n\t\t});\n\n\t\tthis.gameState.initNewGame(playersNumber);\n\t\tthis.gameState.startGame();\n\t}\n\n\tmakeMove(cardId) {\n\t\tif (this.state.mode === 'single-player') {\n\t\t\tthis.gameState.makeUserMove(cardId);\n\t\t} else {\n\t\t\twebsocket.send({ type: 'move', data: { cardId } });\n\t\t}\n\t}\n\n\tpass() {\n\t\tif (this.state.mode === 'single-player') {\n\t\t\tthis.gameState.pass();\n\t\t} else {\n\t\t\twebsocket.send({ type: 'pass' });\n\t\t}\n\t}\n\n\tskip() {\n\t\twebsocket.send({ type: 'skip' });\n\t}\n\n\thandleStartTrick(prevState) {\n\t\tif (this.state.mode === 'multiplayer') return;\n\t\tconst prevAttacks = prevState.cards.table;\n\t\tconst currAttacks = this.state.cards.table;\n\t\tconst prevTrump = prevState.trumpSuit;\n\t\tconst currTrump = this.state.trumpSuit;\n\t\tconst tableGetEmpty = !!prevAttacks.length && !currAttacks.length;\n\t\tconst trumpHasChosen = !prevTrump && currTrump;\n\t\tif (tableGetEmpty || trumpHasChosen) this.gameState.startTrick();\n\t}\n\n\thandleShowButton(prevState) {\n\t\tconst { possibleCards: prevPossibleCards } = prevState;\n\t\tconst { possibleCards, cards: { table: attacks }, showButton } = this.state;\n\t\tif (possibleCards.length && attacks.length) {\n\t\t\tif (prevPossibleCards.length !== possibleCards.length && !showButton) {\n\t\t\t\tthis.setState({ showButton: true });\n\t\t\t}\n\t\t} else if (showButton) this.setState({ showButton: false });\n\t}\n\n\thandleEndGame(prevState) {\n\t\tif (prevState.isPlaying && !this.state.isPlaying) {\n\t\t\tif (this.state.mode === 'multiplayer') {\n\t\t\t\twebsocket.close();\n\t\t\t} else {\n\t\t\t\tthis.gameState = null;\n\t\t\t\tthis.unsubscribe();\n\t\t\t}\n\t\t}\n\t}\n\n\treduceTimer() {\n\t\tconst { timer } = this.state;\n\t\tthis.setState({timer: timer - 1 });\n\t\tif (timer === 1) this.skip();\n\t\telse this.timeout = setTimeout(this.reduceTimer, 1000);\n\t}\n\n\thandleTimerUpdate(prevState) {\n\t\tif (this.state.mode === 'multiplayer') {\n\t\t\tif (prevState.possibleCards.length !== this.state.possibleCards.length) {\n\t\t\t\tif (this.state.possibleCards.length) {\n\t\t\t\t\tthis.setState({timer: 10});\n\t\t\t\t\tif (this.timeout) clearTimeout(this.timeout);\n\t\t\t\t\tthis.timeout = setTimeout(this.reduceTimer, 1000);\n\t\t\t\t} else {\n\t\t\t\t\tthis.setState({timer: null});\n\t\t\t\t\tif (this.timeout) clearTimeout(this.timeout);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.updateViewport();\n\t\tthis.getUserSettings();\n\t\tthis.removeListener = this.addResizeListener();\n\t}\n\n\tcomponentDidUpdate(_, prevState) {\n\t\tthis.handleStartTrick(prevState);\n\t\tthis.handleShowButton(prevState);\n\t\tthis.handleEndGame(prevState);\n\t\tthis.handleTimerUpdate(prevState);\n\t}\n\n\tcomponentWillUnmount() {\n\t\tif (this.removeListener) this.removeListener();\n\t\tif (this.unsubscribe) this.unsubscribe();\n\t}\n\n\trender() {\n\t\tconst field = helpers.getFieldProps(this.state.viewport);\n\t\treturn (\n\t\t\t<AppContext.Provider value={{\n\t\t\t\tcardStyles: this.cardStyles, \n\t\t\t\tpossibleCards: this.state.possibleCards, \n\t\t\t\ttrumpSuit: this.state.trumpSuit, \n\t\t\t\tmovedCard: this.state.movedCard,\n\t\t\t\tupdateCardStyles: this.updateCardStyles, \n\t\t\t\tmakeMove: this.makeMove,\n\t\t\t\taddMovedCard: this.addMovedCard,\n\t\t\t\tremoveMovedCard: this.removeMovedCard\n\t\t\t}}>\n\t\t\t\t<Menu \n\t\t\t\t\tisPlaying={this.state.isPlaying}\n\t\t\t\t\tusername={this.state.username}\n\t\t\t\t\tmode={this.state.mode} \n\t\t\t\t\tplayersNumber={this.state.playersNumber} \n\t\t\t\t\tchangeName={this.changeName}\n\t\t\t\t\tchangeMode={this.changeMode} \n\t\t\t\t\tchangePlayersNumber={this.changePlayersNumber}\n\t\t\t\t\tstartGame={this.startGame}\n\t\t\t\t\twaitUsers={this.waitUsers}\n\t\t\t\t\tsaveUserSettings={this.saveUserSettings}\n\t\t\t\t/>\n\t\t\t\t<WaitPage \n\t\t\t\t\tusername={this.state.username} \n\t\t\t\t\tplayersNumber={this.state.playersNumber} \n\t\t\t\t\tisPlaying={this.state.isPlaying}\n\t\t\t\t\tisWaiting={this.state.isWaiting}\n\t\t\t\t\tcancelWaiting={this.cancelWaiting}\n\t\t\t\t\tstartMultiplayGame={this.startMultiplayGame}\n\t\t\t\t/>\n\t\t\t\t<svg className=\"app\" >\n\t\t\t\t\t<g className=\"field\" width={field.width} height={field.height} style={field.style}>\n\t\t\t\t\t\t<Table field={field} />\n\t\t\t\t\t\t<Cards \n\t\t\t\t\t\t\tcards={this.state.cards} \n\t\t\t\t\t\t\tfield={field} \n\t\t\t\t\t\t\tplayers={this.state.players} \n\t\t\t\t\t\t\tuserIndex={this.state.userIndex}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<PassButton\n\t\t\t\t\t\t\tshow={this.state.showButton}\n\t\t\t\t\t\t\ttext={this.state.defender === this.state.userIndex ? 'Pick up' : 'Pass'}\n\t\t\t\t\t\t\tonClick={this.state.showButton ? this.pass : null}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Arrow \n\t\t\t\t\t\t\tfield={field}\n\t\t\t\t\t\t\tdefenderIndex={this.state.defender} \n\t\t\t\t\t\t\tplayersCount={this.state.players.length} \n\t\t\t\t\t\t\tuserIndex={this.state.userIndex}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Timer timer={this.state.timer} />\n\t\t\t\t\t</g>\n\t\t\t\t\t<Filters />\n\t\t\t\t</svg>\n\t\t\t</AppContext.Provider>\n\t\t);\n\t}\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './components/App';\nimport './stylesheets/index.css';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <App />,\n  document.getElementById('root')\n);\n\n// @TODO to learn about\nserviceWorker.unregister();\n"],"sourceRoot":""}