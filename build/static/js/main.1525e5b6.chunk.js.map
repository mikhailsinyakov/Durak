{"version":3,"sources":["websocket/index.js","context/AppContext.js","components/Menu.js","components/WaitPage.js","components/Table.js","components/TrumpSymbol.js","lib/gameConfig.js","components/Card.js","components/DeckCards.js","lib/helpers.js","components/PlayerCards.js","components/TableCards.js","components/DiscardedCards.js","components/Cards.js","components/PassButton.js","components/Arrow.js","components/Timer.js","components/Filters.js","lib/GameState.js","lib/delayed-functions.js","components/App.js","serviceWorker.js","index.js"],"names":["websocketUrl","window","location","hostname","websocket","client","connect","this","w3cwebsocket","listen","fn","onclose","onerror","error","onmessage","message","JSON","parse","data","send","messageObject","_this","stringify","readyState","OPEN","onopen","close","AppContext","React","createContext","MenuItemOption","props","changeItem","currOption","option","optionText","react_default","a","createElement","className","concat","onClick","style","cursor","Menu","username","mode","playersNumber","changeName","changeMode","isPlaying","changePlayersNumber","startGame","waitUsers","saveUserSettings","input","createRef","handleInputChange","e","value","target","current","placeholder","toUpperCase","slice","handleSubmit","lang","context_AppContext","Consumer","_ref","ref","type","onChange","Menu_MenuItemOption","WaitPage","Object","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","state","joinedUsers","userConfirms","allUsersConfirm","cancel","bind","assertThisInitialized","confirm","setState","startMultiplayGame","cancelWaiting","_this2","msgObj","updateJoinedUsers","groupSize","prevProps","isWaiting","connectToWebsocket","_this$props","_this$state","context","length","map","user","i","key","Component","contextType","Table","field","cx","width","cy","height","r","playerSpace","TrumpSymbol","placeCenter","cardSize","coords","x","y","_ref2","trumpSuit","href","transform","config","maxCardsAfterDealing","maxAttacks","Card","imageElement","id","rotation","side","activePlayer","_this$context","possibleCards","makeMove","cardStyles","updateCardStyles","movedCard","addMovedCard","removeMovedCard","gameConfig","translate","rotate","cardStyle","newStyle","transformOrigin","darker","includes","applyStyle","elem","transition","filter","changeStyles","requestAnimationFrame","setTimeout","onMouseOver","onMouseLeave","DeckCards","cards","react","card","shift","trump","objectSpread","components_Card","assign","components_TrumpSymbol","toRadian","angle","Math","PI","findRightTriangleSides","hypotenuse","cos","sin","getDeepCopy","obj","isArray","Array","newArray","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","entries","Symbol","iterator","next","done","_ref3","slicedToArray","err","return","newObj","prop","PlayerCards","players","playerCardsPosition","userIndex","allCards","playerIndex","_playerCardsPosition$","objectWithoutProperties","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","_ref6","_ref5","cardIndex","oneCardShift","relativeToPlaceCenter","helpers","push","TableCards","attacks","_ref4","attackIndex","attack","_ref7","attacking","DiscardedCards","Cards","placeCenters","deck","table","discarded","components_DeckCards","components_PlayerCards","fromCenterToPlayerCards","from","_","relativeToCenterCoords","findPlayerCardsPosition","components_TableCards","components_DiscardedCards","PassButton","show","text","opacity","Arrow","defenderIndex","playersCount","fromCenter","relativeToCenter","points","Timer","timer","Filters","values","GameState","attacker","defender","defendSucceed","activePlayers","observable","subscriber","subscribe","update","updates","deckCards","shuffleCards","genCards","playerCards","ranks","suits","n","rank","suit","cardsCopy","j","floor","random","tmp","dealCards","chooseTrump","clearGameProps","dealerIndex","getNextIndex","index","dealOneCard","randomIndex","sortPlayerCards","pop","isTrump","sort","b","card1","card2","getNumberOfActivePlayers","endGame","updateActivePlayers","updateAttackerAndDefender","updateMaxAttacks","sendPossibleCardsToUser","decision","makeDecision","updateActivePlayerTimers","playerObject","pass","rejected","gameState","isPlayerInGame","nextIndex","indexes","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_step3","_iterator3","playersDontHaveTimers","userPass","defineAttackerAndDefenderByLowestTrump","minTrump","_iteratorNormalCompletion4","_didIteratorError4","_iteratorError4","_step4","_iterator4","_iteratorNormalCompletion5","_didIteratorError5","_iteratorError5","_step5","_iterator5","min","findPossibleCards","findCardsForDefend","findCardsForAttack","tableCards","_iteratorNormalCompletion6","_didIteratorError6","_iteratorError6","_step6","_iterator6","apply","toConsumableArray","tableCardRanks","_this3","notBeatenAttacks","_iteratorNormalCompletion7","_didIteratorError7","_iteratorError7","_step7","_loop","attackCard","getHigherCard","forEach","_iterator7","isDefender","isAttackRequired","cardsInDeck","unbeatenCards","cardId","getCardById","addCardToTable","playerCard","defendCard","_this4","attackIndexes","place","_iteratorNormalCompletion8","_didIteratorError8","_iteratorError8","_step8","_iterator8","_iteratorNormalCompletion9","_didIteratorError9","_iteratorError9","_step9","_iterator9","_this5","isUserInGame","userHasNoPossibleCards","_iteratorNormalCompletion10","_didIteratorError10","_iteratorError10","_step10","_loop2","randomTime","_playerObject$rejecte","_iterator10","endTrick","reduce","bool","clearTable","drawCardsFromDeck","_this6","discardedCards","_iteratorNormalCompletion11","_didIteratorError11","_iteratorError11","_step11","_iterator11","_iteratorNormalCompletion12","_didIteratorError12","_iteratorError12","_step12","_iterator12","_this7","playersDrawnCards","changePlayers","newCards","playerHasCards","cardsNeeded","lastDeckCard","loser","_iteratorNormalCompletion13","_didIteratorError13","_iteratorError13","_step13","_iterator13","_ref9","_ref8","delayed_functions","functions","delaying","add","run","App","viewport","showButton","timeout","handleStateUpdate","updateViewport","reduceTimer","settingsString","localStorage","getItem","settings","setItem","name","number","delayedFunctions","defineProperty","html","document","documentElement","clientWidth","clientHeight","throttled","addEventListener","removeEventListener","updateObject","unsubscribe","addObserver","genPlayers","initNewGame","makeUserMove","prevState","prevAttacks","currAttacks","prevTrump","currTrump","startTrick","prevPossibleCards","_this$state2","skip","clearTimeout","getUserSettings","removeListener","addResizeListener","handleStartTrick","handleShowButton","handleEndGame","handleTimerUpdate","svg","aspectRatio","scale","Provider","components_Menu","components_WaitPage","components_Table","components_Cards","components_PassButton","components_Arrow","components_Timer","components_Filters","Boolean","match","pathname","title","ReactDOM","render","components_App","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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","file":"static/js/main.1525e5b6.chunk.js","sourcesContent":["import { w3cwebsocket } from 'websocket';\nconst websocketUrl = window.location.hostname === 'localhost' ?\n  'ws://127.0.0.1:8080' :\n  'wss://durak-app.herokuapp.com/';\n\nconst websocket = {\n  client: null,\n  connect() {\n    if (!this.client) {\n      this.client = new w3cwebsocket(websocketUrl, 'echo-protocol');\n    }\n  },\n  listen(fn) {\n    this.client.onclose = () => fn('closed');\n    this.client.onerror = error => fn('error', error);\n    this.client.onmessage = message => \n      fn('message', JSON.parse(message.data));\n  },\n  send(messageObject) {\n    const message = JSON.stringify(messageObject);\n    if (this.client.readyState === this.client.OPEN) {\n      this.client.send(message);\n    } else {\n      this.client.onopen = () => this.client.send(message);\n    }\n  },\n  close() {\n    if (this.client) {\n      this.client.close();\n      this.client = null;\n    }\n  }\n};\n\nexport default websocket;","import React from 'react';\n\nconst AppContext = React.createContext();\n\nexport default AppContext;","import React from 'react';\nimport AppContext from '../context/AppContext';\nimport '../stylesheets/Menu.css';\n\nconst MenuItemOption = props => {\n  const { changeItem, currOption, option, optionText } = props;\n  return (\n    <span \n      className={`menu-item-option ${currOption === option ? 'current' : ''}`}\n      onClick={currOption !== option ? () => changeItem(option) : null}\n      style={{ cursor: currOption !== option ? 'pointer' : 'default' }}\n    >\n      {optionText}\n    </span>\n  );\n};\n\nconst Menu = props => {\n  const { username, mode, playersNumber, changeName, changeMode, isPlaying,\n          changePlayersNumber, startGame, waitUsers, saveUserSettings } = props;\n          \n  const input = React.createRef();\n\n  const handleInputChange = e => {\n    let { value } = e.target;\n    if (input.current.placeholder) input.current.placeholder = '';\n    if (value) value = value[0].toUpperCase() + value.slice(1);\n    changeName(value);\n  };\n\n\n  const handleSubmit = lang => {\n    if (!username) {\n      input.current.placeholder = lang === 'ru' ? 'Введите имя': 'You should enter name';\n      return;\n    }\n    if (mode === 'single-player') {\n      saveUserSettings();\n      startGame();\n    } else {\n      saveUserSettings();\n      waitUsers();\n    }\n  };\n\n  return (\n    <AppContext.Consumer>\n      { ({lang}) => (\n        <div className={`menu ${isPlaying ? 'hide' : ''}`}>\n          <h1>{lang === 'ru' ? 'Меню' : 'Menu'}</h1>\n          <div className=\"menu-items\">\n            <label className=\"menu-item\">\n              <span className=\"menu-item-name\">\n                {lang === 'ru' ? 'Имя:' : 'Name:'}\n              </span>\n              <input ref={input} type=\"text\" value={username} onChange={handleInputChange} />\n            </label>\n            <div className=\"menu-item\">\n              <span className=\"menu-item-name\">\n                {lang === 'ru' ? 'Режим:' : 'Mode:'}\n              </span>\n              <MenuItemOption \n                changeItem={changeMode} currOption={mode} \n                option=\"single-player\" \n                optionText={lang === 'ru' ? 'С Компьютером' : 'Single Player'}\n              />\n              <MenuItemOption \n                changeItem={changeMode} currOption={mode}\n                option=\"multiplayer\" \n                optionText={lang === 'ru' ? 'С Другими Игроками' : 'Multiplayer'}\n              />\n            </div>\n            <div className=\"menu-item\">\n              <span className=\"menu-item-name\">\n                {lang === 'ru' ? 'Число Игроков:' : 'Players Number:'}\n              </span>\n              <MenuItemOption \n                changeItem={changePlayersNumber} currOption={playersNumber} \n                option={2} optionText=\"2\"\n              />\n              <MenuItemOption \n                changeItem={changePlayersNumber} currOption={playersNumber} \n                option={3} optionText=\"3\"\n              />\n              <MenuItemOption \n                changeItem={changePlayersNumber} currOption={playersNumber} \n                option={4} optionText=\"4\"\n              />\n              <MenuItemOption \n                changeItem={changePlayersNumber} currOption={playersNumber} \n                option={5} optionText=\"5\"\n              />\n              <MenuItemOption \n                changeItem={changePlayersNumber} currOption={playersNumber} \n                option={6} optionText=\"6\"\n              />\n            </div>\n          </div>\n          <button onClick={handleSubmit} >\n            {mode === 'single-player' ? \n              lang === 'ru' ? 'Играть' : 'Play' : \n              lang === 'ru' ? 'Ждать Других Игроков' : 'Wait for Users'}\n          </button>\n        </div>\n      )}\n    </AppContext.Consumer>\n\n  );\n};\n\nexport default Menu;","import React, { Component } from 'react';\nimport AppContext from '../context/AppContext';\nimport websocket from '../websocket';\nimport '../stylesheets/WaitPage.css';\n\nclass WaitPage extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      joinedUsers: [],\n      userConfirms: false,\n      allUsersConfirm: false\n    };\n\n    this.cancel = this.cancel.bind(this);\n    this.confirm = this.confirm.bind(this);\n  }\n\n  updateJoinedUsers(joinedUsers) {\n    this.setState({ joinedUsers, playersNumber: this.state.playersNumber });\n  }\n\n  confirm() {\n    this.setState({ userConfirms: true });\n    websocket.send({ type: 'confirm' });\n  }\n\n  allUsersConfirm() {\n    this.props.startMultiplayGame();\n  }\n\n  cancel() {\n    this.props.cancelWaiting();\n    websocket.close();\n  }\n\n  connectToWebsocket() {\n    websocket.connect();\n    websocket.listen((type, msgObj) => {\n      if (type === 'message') {\n        if (msgObj.type === 'joinedUsers') this.updateJoinedUsers(msgObj.data.joinedUsers);\n        if (msgObj.type === 'allUsersConfirm') this.allUsersConfirm();\n      }\n      if (type === 'closed') this.cancel();\n    });\n    websocket.send({ \n      type: 'addData',\n      username: this.props.username,\n      groupSize: this.props.playersNumber\n    });\n  }\n\n  componentDidUpdate(prevProps) {\n    if (!prevProps.isWaiting && !prevProps.isPlaying && this.props.isWaiting) {\n      this.connectToWebsocket();\n      this.setState({ joinedUsers: [], userConfirms: false, allUsersConfirm: false });\n    }\n  }\n\n  render() {\n    const { isWaiting, playersNumber } = this.props;\n    const { joinedUsers, userConfirms } = this.state;\n    const { lang } = this.context;\n\n    return (\n      <div className={`wait-page ${!isWaiting ? 'hide' : ''}`}>\n        <h1>{lang === 'ru' ? 'Ожидание Игроков' : 'Wait for Users'}</h1>\n        <div className=\"info\">\n          {!!joinedUsers.length && \n            <p><b>{lang === 'ru' ? 'Присоединившиеся Игроки: ' : 'Joined Users: '}</b>\n              {joinedUsers.map((user, i) => \n                <span key={i}>{i ? ', ' + user : ' ' + user}</span>)}\n            </p>\n          }\n          <p><b>{lang === 'ru' ? 'Осталось Ждать: ' : 'Remains to wait: '}</b> \n            {playersNumber - joinedUsers.length}</p>\n          {userConfirms && <p>{lang === 'ru' ? \n            'Ожидание Подтверждения Игроков' : \n            'Waiting for Users to Confirm'}</p>}\n        </div>\n        <div className=\"buttons\">\n          <button className=\"cancel-button\" onClick={this.cancel}>\n            {lang === 'ru' ? 'Отмена' : 'Cancel'}\n          </button>\n          {\n            joinedUsers.length === playersNumber && !userConfirms &&\n            <button className=\"confirm-button\" onClick={this.confirm}>\n              {lang === 'ru' ? 'Подтвердить' : 'Confirm'}\n            </button>\n          }\n        </div>\n      </div>\n    );\n  }\n}\nWaitPage.contextType = AppContext;\n\nexport default WaitPage;","import React from 'react';\nimport '../stylesheets/Table.css';\n\nconst Table = ({field}) => {\n  const style = {\n    cx: field.width / 2 + 'px',\n    cy: field.height / 2 + 'px',\n    r: (field.width - field.playerSpace * 2) / 2 + 'px'\n  };\n  return <circle className=\"table\" style={style} />;\n};\n\nexport default Table;\n","import React from 'react';\nimport AppContext from '../context/AppContext';\n\nconst TrumpSymbol = ({ placeCenter }) => {\n  const cardSize = {\n    width: 50,\n    height: 77.78\n  };\n\n  const coords = {\n    x: placeCenter.x - cardSize.width / 2,\n    y: placeCenter.y - cardSize.height / 2\n  };\n  \n  return (\n    <AppContext.Consumer>\n      {\n        ({trumpSuit}) => {\n          if (trumpSuit) {\n            return (\n              <image\n                x={0}\n                y={0}\n                width={cardSize.width}\n                height={cardSize.height}\n                href={`/images/card-suits/${trumpSuit}.svg`}\n                style={{transform: `translate(${coords.x}px, ${coords.y}px)`}}\n              />\n            );\n          } else return null\n        }\n      }\n    </AppContext.Consumer>\n  );\n};\n\nexport default TrumpSymbol;","const config = {\n  cardSize: {\n    width: 50,\n    height: 77.78\n  },\n  maxCardsAfterDealing: 6,\n  maxAttacks: 6\n};\n\nexport default config;\n","import React, { Component } from 'react';\nimport AppContext from '../context/AppContext';\nimport gameConfig from '../lib/gameConfig';\n\nclass Card extends Component {\n  constructor(props) {\n    super(props);\n    this.imageElement = React.createRef();\n  }\n\n  render() {\n    const { id, rotation, coords, side, activePlayer } = this.props;\n    const { possibleCards, makeMove, cardStyles, \n            updateCardStyles, movedCard, addMovedCard, removeMovedCard } = this.context;\n    const { imageElement } = this;\n    const { cardSize } = gameConfig;\n\n    const x = coords.x - cardSize.width / 2;\n    let y = coords.y - cardSize.height / 2;\n    if (activePlayer && movedCard === id) y -= 20;\n    const translate = `translate(${x}px, ${y}px)`;\n    const rotate = `rotate(${rotation ? rotation + 'deg' : '0deg'})`;\n    const cardStyle = cardStyles ? cardStyles[id] : null;\n    const newStyle = {\n      transformOrigin: `${coords.x}px ${coords.y}px`,\n      transform: `${rotate} ${translate}`\n    };\n\n    const darker = activePlayer && !possibleCards.includes(id);\n  \n    const applyStyle = (elem, style, transition) => {\n      elem.style.transform = style.transform;\n      elem.style.transformOrigin = style.transformOrigin;\n      elem.style.transition = transition ? '0.3s' : '0s';\n      elem.style.cursor = activePlayer && !darker ? 'pointer' : 'auto';\n      elem.style.filter = darker ? 'url(\"#darker\")' : 'none';\n    };\n\n  \n    (function changeStyles() {\n      window.requestAnimationFrame(() => {\n        const elem = imageElement.current;\n        if (!elem) changeStyles();\n        else {\n          if (cardStyle) {\n            applyStyle(elem, cardStyle, false);\n            window.requestAnimationFrame(() => {\n              applyStyle(elem, newStyle, true);\n              updateCardStyles(id, newStyle);\n            });\n          } else {\n            applyStyle(elem, newStyle, false);\n            updateCardStyles(id, newStyle);\n          }\n        }\n      });\n    })();\n\n    const moveCardUp = () => {\n      if (!movedCard && activePlayer && !darker) addMovedCard(id);\n    };\n\n    const moveCardDown = () => {\n      if (movedCard === id) removeMovedCard();\n    };\n  \n    const onClick = () => {\n      if (activePlayer && !darker) {\n        makeMove(id);\n        if (movedCard === id) setTimeout(removeMovedCard, 300);\n      }\n    };\n  \n    return (\n      <image\n        ref={this.imageElement}\n        x={0}\n        y={0}\n        width={cardSize.width}\n        height={cardSize.height}\n        href={side === 'front' ?\n          `/images/cards/${id}.png` :\n          `/images/cards/back.png`\n        }\n        id={id}\n        className=\"card\"\n        onClick={onClick}\n        onMouseOver={moveCardUp}\n        onMouseLeave={moveCardDown}\n      />\n    );\n  }\n}\n\nCard.contextType = AppContext;\n\nexport default Card;\n","import React, { Fragment } from 'react';\nimport TrumpSymbol from './TrumpSymbol';\nimport Card from './Card';\n\nconst DeckCards = props => {\n  const { cards, placeCenter } = props;\n  \n  const addProps = (card, i) => {\n    const shift = {\n      x: i * 0.1 + (card.trump ? -19 : 0),\n      y: -i * 0.1 + (card.trump ? 13 : 0)\n    };\n    const coords = {\n      x: placeCenter.x + shift.x,\n      y: placeCenter.y + shift.y\n    };\n    const rotation = card.trump ? 90 : 0;\n    return {\n      ...card,\n      coords,\n      rotation,\n      side: card.trump ? 'front' : 'back'\n    };\n  };\n\n  return (\n    <Fragment>\n      {\n        cards.length ?\n          cards.map(addProps).map(card => <Card {...card} key={card.id} />) :\n          <TrumpSymbol placeCenter={placeCenter} />\n      }\n    </Fragment>\n  );\n};\n\nexport default DeckCards;\n","const toRadian = angle => angle * Math.PI / 180;\n\nexport const findRightTriangleSides = (angle, hypotenuse) => {\n  return {\n    x: Math.cos(toRadian(angle)) * hypotenuse,\n    y: Math.sin(toRadian(angle)) * hypotenuse\n  };\n};\n\nexport const getDeepCopy = obj => {\n  const isArray = obj instanceof Array;\n  const isObj = typeof obj === 'object' && !isArray;\n  if (!isArray && !isObj) return obj;\n  if (isArray) {\n    const newArray = [];\n    for (const [i, elem] of obj.entries()) {\n      newArray[i] = getDeepCopy(elem);\n    }\n    return newArray;\n  } \n  // It is object\n  const newObj = {};\n  for (const prop in obj) {\n    newObj[prop] = getDeepCopy(obj[prop]);\n  }\n  return newObj;\n};\n\nexport const getFieldProps = viewport => {\n  const svg = {\n    ...viewport,\n    aspectRatio: viewport.width / viewport.height\n  };\n\n  const field = {\n    width: 700,\n    height: 600,\n    playerSpace: 150,\n    aspectRatio: 700 / 600\n  };\n\n  if (svg.aspectRatio > field.aspectRatio) {\n    field.scale = svg.height / field.height;\n    field.x = (svg.width - (field.width * field.scale)) / 2;\n    field.y = 0;\n  } else {\n    field.scale = svg.width / field.width;\n    field.x = 0;\n    field.y = (svg.height - (field.height * field.scale)) / 2;\n  }\n\n  field.style = {\n    transform: `translate(${field.x}px, ${field.y}px) scale(${field.scale})`\n  };\n\n  return field;\n};","import React, { Fragment } from 'react';\nimport Card from './Card';\nimport * as helpers from '../lib/helpers';\n\nconst PlayerCards = props => {\n  const { players, playerCardsPosition, userIndex } = props;\n  const allCards = [];\n\n  for (const [playerIndex, cards] of players.entries()) {\n    const { angle, ...placeCenter } = playerCardsPosition[playerIndex];\n    for (const [cardIndex, card] of cards.entries()) {\n      const oneCardShift = playerIndex === userIndex ? 20 : 5;\n      const shift = (cardIndex - (cards.length - 1) / 2) * oneCardShift;\n      const relativeToPlaceCenter = helpers.findRightTriangleSides(\n        angle,\n        shift\n      );\n      const coords = {\n        x: placeCenter.x + relativeToPlaceCenter.x,\n        y: placeCenter.y + relativeToPlaceCenter.y\n      };\n\n      allCards.push({\n        ...card,\n        rotation: angle,\n        coords,\n        side: playerIndex === userIndex ? 'front' : 'back',\n        activePlayer: playerIndex === userIndex\n      });\n    }\n  }\n\n  return (\n    <Fragment>\n      {allCards.map(card =>  <Card { ...card } key={card.id} />)}\n    </Fragment>\n  );\n};\n\nexport default PlayerCards;\n","import React, { Fragment } from 'react';\nimport Card from './Card';\n\nconst TableCards = ({ attacks, placeCenter }) => {\n  const allCards = [];\n  for (const [attackIndex, attack] of attacks.entries()) {\n    for (const [cardIndex, card] of attack.entries()) {\n      const attacking = cardIndex === 0;\n      const shift = {};\n      if (attacks.length > 3) {\n        if (attackIndex > 2) {\n          shift.x = attackIndex - 3 - (attacks.length - 4) / 2;\n          shift.y = 1;\n        } else {\n          shift.x = attackIndex - 1;\n          shift.y = -1;\n        }\n      } else {\n        shift.x = attackIndex - (attacks.length - 1) / 2;\n        shift.y = 0;\n      }\n\n      if (!attacking) {\n        shift.x += 0.05;\n        shift.y += 0.4;\n      }\n\n      shift.x = shift.x * 70;\n      shift.y = shift.y * 60;\n\n      const coords = {\n        x: placeCenter.x + shift.x,\n        y: placeCenter.y + shift.y\n      };\n\n      allCards.push({ ...card, coords, side: 'front' });\n    }\n  }\n\n  return (\n    <Fragment>\n      {allCards.map(card => <Card { ...card } key={card.id} />)}\n    </Fragment>\n  );\n};\n\nexport default TableCards;\n","import React, { Fragment } from 'react';\nimport Card from './Card';\n\nconst DiscardedCards = ({ cards, placeCenter }) => (\n  <Fragment>\n    {cards.map(card => \n      <Card {...card} key={card.id} coords={ {...placeCenter} } side= 'back' />\n    )}\n  </Fragment>\n);\n\nexport default DiscardedCards;\n","import React, { Fragment } from 'react';\nimport DeckCards from './DeckCards';\nimport PlayerCards from './PlayerCards';\nimport TableCards from './TableCards';\nimport DiscardedCards from './DiscardedCards';\nimport * as helpers from '../lib/helpers';\n\nconst Cards = props => {\n  const { cards, field, players, userIndex } = props;\n  const findPlayerCardsPosition = () => {\n    const avgSide = (field.width + field.height) / 2;\n    const fromCenterToPlayerCards = avgSide / 2 - field.playerSpace / 2;\n\n    return Array.from(\n      { length: players.length },\n      (_, i) => {\n        const angle = (i - userIndex) * 360 / players.length;\n        const relativeToCenterCoords = helpers.findRightTriangleSides(\n          angle + 90,\n          fromCenterToPlayerCards\n        );\n        return {\n          angle,\n          x: field.width / 2 + relativeToCenterCoords.x,\n          y: field.height / 2 + relativeToCenterCoords.y\n        };\n      }\n    );\n  };\n\n  const placeCenters = {\n    deck: {\n      x: field.width * 0.36,\n      y: field.height * 0.5\n    },\n    table: {\n      x: field.width * 0.55,\n      y: field.height * 0.48\n    },\n    discarded: {\n      x: field.width * 1.7,\n      y: field.height * 0.5\n    }\n  };\n\n  return (\n    <Fragment>\n      <DeckCards cards={cards.deck} placeCenter={placeCenters.deck} />\n      <PlayerCards \n        players={cards.players} \n        playerCardsPosition={findPlayerCardsPosition()} \n        userIndex={userIndex}\n      />\n      <TableCards attacks={cards.table} placeCenter={placeCenters.table} />\n      <DiscardedCards cards={cards.discarded} placeCenter={placeCenters.discarded} />\n    </Fragment>\n  );\n};\n\nexport default Cards;\n","import React from 'react';\nimport '../stylesheets/PassButton.css';\n\nconst PassButton = ({show, text, onClick}) => {\n  const style = {\n    opacity: show ? 1 : 0,\n    cursor: show ? 'pointer' : 'default'\n  };\n\n  return (\n    <g\n      className=\"pass-button\"\n      style={style}\n      onClick={onClick}\n    >\n      <rect />\n      <text>{text}</text>\n    </g>\n  );\n};\n\nexport default PassButton;\n","import React from 'react';\nimport * as helpers from '../lib/helpers';\nimport '../stylesheets/Arrow.css';\n\nconst Arrow = ({field, defenderIndex, playersCount, userIndex}) => {\n\tif (defenderIndex === null) return null;\n\tconst angle = (defenderIndex - userIndex) * 360 / playersCount;\n\tconst fromCenter = (field.width - field.playerSpace * 2) / 2 - 35;\n\tconst relativeToCenter = helpers.findRightTriangleSides(\n\t\tangle + 95,\n\t\tfromCenter\n\t);\n\tconst x = field.width / 2 + relativeToCenter.x;\n\tconst y = field.height / 2 + relativeToCenter.y;\n\n\tconst style = {\n\t\ttransform: `rotate(${angle}deg) translate(${x}px, ${y}px)`,\n\t\ttransformOrigin: `${x}px ${y}px`\n\t};\n\n\treturn (\n\t\t<polygon className=\"arrow\" points=\"0,0 28,0 14,28\" x={0} y={0} style={style} />\n\t)\n};\n\nexport default Arrow;","import React from 'react';\nimport '../stylesheets/Timer.css'\n\nconst Timer = ({ timer }) => {\n  if (timer === null) return null;\n\n  return (\n    <g className=\"timer\" >\n      <rect />\n      <text>{timer}</text>\n    </g>\n  );\n  \n};\n\nexport default Timer;","import React from 'react';\n\nconst Filters = () => {\n  return (\n    <defs>\n      <filter id=\"darker\">\n        <feColorMatrix\n          type=\"matrix\"\n          values=\".6   0   0   0   0\n                  0  .6   0   0   0\n                  0   0  .6   0   0\n                  0   0   0   1   0 \"/>\n      </filter>\n    </defs>\n  );\n};\n\nexport default Filters;\n","import config from './gameConfig';\nimport * as helpers from './helpers';\n\nclass GameState {\n  constructor(mode) {\n    this.cards = {\n      deck: [],\n      players: [],\n      table: [],\n      discarded: []\n    };\n    this.userIndex = 0;\n    this.trumpSuit = null;\n    this.attacker = null;\n    this.defender = null;\n    this.defendSucceed = null;\n    this.activePlayers = {\n      players: []\n    };\n    this.maxAttacks = 0;\n    this.observable = {\n      subscriber: null,\n      subscribe(fn) {\n        this.subscriber = fn;\n        return () => this.subscriber = null;\n      },\n      update(updates) {\n        this.subscriber(updates);\n      }\n    };\n  }\n  initNewGame(playersNumber) {\n    const deckCards = this.shuffleCards(this.genCards());\n    const playerCards = Array.from({length: playersNumber}, () => ([]));\n    this.cards = {\n      ...this.cards,\n      deck: deckCards,\n      players: playerCards\n    };\n    this.observable.update([{ prop: 'cards', value: this.cards }]);\n  }\n  genCards() {\n    const ranks = [\n      '2', '3', '4', '5', '6', '7', '8', '9', '10', 'J', 'Q', 'K', 'A'\n    ];\n    const values = [\n      2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14\n    ];\n    const suits = ['clubs', 'diamonds', 'hearts', 'spades'];\n    const cards = [];\n    for (let i = 0; i < ranks.length; i++) {\n      for (let n = 0; n < suits.length; n++) {\n        cards.push({\n          id: `${ranks[i]}-${suits[n]}`,\n          rank: ranks[i],\n          suit: suits[n],\n          value: values[i]\n        });\n      }\n    }\n\n    return cards;\n  }\n  shuffleCards(cards) {\n    const cardsCopy = helpers.getDeepCopy(cards);\n\n    for (let i = cardsCopy.length - 1; i > 0; i--) {\n      const j = Math.floor(Math.random() * (i + 1));\n      const tmp = helpers.getDeepCopy(cardsCopy[i]);\n      cardsCopy[i] = helpers.getDeepCopy(cardsCopy[j]);\n      cardsCopy[j] = helpers.getDeepCopy(tmp);\n    }\n\n    return cardsCopy;\n  }\n  startGame() {\n    this.dealCards();\n    this.chooseTrump();\n    this.clearGameProps();\n  }\n  dealCards() {\n    const dealerIndex = this.userIndex;\n    const playersNumber = this.cards.players.length;\n    const getNextIndex = index => index + 1 === playersNumber ? 0 : index + 1;\n    let index = getNextIndex(dealerIndex);\n    while(this.cards.players[index].length < config.maxCardsAfterDealing) {\n      this.dealOneCard(index);\n      this.observable.update([{ prop: 'cards', value: this.cards }]);\n      index = getNextIndex(index);\n    }\n  }\n  chooseTrump() {\n    const deckCards = helpers.getDeepCopy(this.cards.deck);\n    const randomIndex = Math.floor(Math.random() * deckCards.length);\n    const card = deckCards[randomIndex];\n    deckCards[randomIndex] = deckCards[0];\n    deckCards[0] = { ...card, trump: true };\n    this.cards = {\n      ...this.cards,\n      deck: deckCards\n    };\n    this.trumpSuit = card.suit;\n    this.sortPlayerCards();\n    this.observable.update([\n      { prop: 'cards', value: this.cards },\n      { prop: 'trumpSuit', value: this.trumpSuit }\n    ]);\n  }\n  dealOneCard(playerIndex) {\n    const deckCards = helpers.getDeepCopy(this.cards.deck);\n    const playerCards = helpers.getDeepCopy(this.cards.players);\n    const card = deckCards.pop();\n    playerCards[playerIndex].push(card);\n\n    this.cards = {\n      ...this.cards,\n      deck: deckCards,\n      players: playerCards\n    };\n    this.sortPlayerCards();\n  }\n  sortPlayerCards() {\n    const isTrump = card => card.suit === this.trumpSuit;\n    const isEqualSuit = (card1, card2) => {\n      if (!this.trumpSuit) return true;\n      if (isTrump(card1) && isTrump(card2)) return true;\n      if (!isTrump(card1) && !isTrump(card2)) return true;\n      return false;\n    };\n\n    const playerCards = helpers.getDeepCopy(this.cards.players);\n    for (const cards of playerCards) {\n      cards.sort((a, b) => {\n        if (isEqualSuit(a, b)) return a.value - b.value;\n        if (isTrump(a) && !isTrump(b)) return 1;\n        if (!isTrump(a) && isTrump(b)) return -1;\n        return 0;\n      });\n    }\n\n    this.cards = {\n      ...this.cards,\n      players: playerCards\n    };\n  }\n  clearGameProps() {\n    this.defendSucceed = null;\n  }\n  startTrick() {\n    if (this.getNumberOfActivePlayers() < 2) this.endGame();\n    else {\n      this.updateActivePlayers();\n      this.updateAttackerAndDefender();\n      this.updateMaxAttacks();\n      if (this.attacker === this.userIndex) this.sendPossibleCardsToUser();\n      else {\n        const decision = this.makeDecision(this.attacker);\n        this.makeMove(this.attacker, decision);\n        this.updateActivePlayerTimers();\n      }\n    }\n  }\n  getNumberOfActivePlayers() {\n    return this.cards.players.filter(cards => cards.length).length;\n  }\n  updateActivePlayers() {\n    const activePlayers = [];\n    for (const [playerIndex, cards] of this.cards.players.entries()) {\n      if (cards.length) {\n        const playerObject = { index: playerIndex };\n        if (playerIndex === this.userIndex) playerObject.pass = false;\n        else {\n          playerObject.timer = null;\n          playerObject.rejected = [];\n        }\n        activePlayers.push(playerObject);\n      }\n    }\n    const gameState = this;\n    this.activePlayers = {\n      players: activePlayers,\n      isPlayerInGame(index) {\n        return !!this.players.filter(playerObject => playerObject.index === index)[0];\n      },\n      getNextIndex(index) {\n        const indexes = this.players.map(playerObject => playerObject.index);\n        let nextIndex;\n        for (const i of indexes) {\n          if (i > index) {\n            nextIndex = i;\n            break;\n          }\n        }\n        if (nextIndex === undefined) nextIndex = indexes[0];\n        return nextIndex;\n      },\n      playersDontHaveTimers() {\n        const playersWithTimers = this.players.filter(playerObject =>  playerObject.timer);\n        return !playersWithTimers.length;\n      },\n      userPass() {\n        this.players = this.players.map(playerObject => \n          playerObject.index === gameState.userIndex ? \n            ({ ...playerObject, pass: true }) : \n            playerObject)\n      }\n    };\n  }\n  updateAttackerAndDefender() {\n    if (this.defendSucceed === null) this.defineAttackerAndDefenderByLowestTrump();\n    else if (this.defendSucceed) {\n      if (this.activePlayers.isPlayerInGame(this.defender)) {\n        this.attacker = this.defender;\n      } else {\n        this.attacker = this.activePlayers.getNextIndex(this.defender);\n      }\n    } else {\n      this.attacker = this.activePlayers.getNextIndex(this.defender);\n    }\n\n    this.defender = this.activePlayers.getNextIndex(this.attacker);\n\n    this.observable.update([\n      { prop: 'attacker', value: this.attacker },\n      { prop: 'defender', value: this.defender }\n    ])\n  }\n  defineAttackerAndDefenderByLowestTrump() {\n    const playerCards = this.cards.players;\n    const playersNumber = playerCards.length;\n    let minTrump = {\n      playerIndex: null,\n      value: 15\n    };\n    for (const [index, cards] of playerCards.entries()) {\n      for (const card of cards) {\n        if (card.suit === this.trumpSuit && card.value < minTrump.value) {\n          minTrump = {\n            playerIndex: index,\n            value: card.value\n          };\n        }\n      }\n    }\n\n    if (minTrump.playerIndex !== null) {\n      this.attacker = minTrump.playerIndex;\n    } else {\n      const randomIndex = Math.floor(Math.random() * playersNumber);\n      this.attacker = randomIndex;\n    }\n    this.defender = this.activePlayers.getNextIndex(this.attacker);\n  }\n  updateMaxAttacks() {\n    this.maxAttacks = Math.min(\n      this.cards.players[this.defender].length,\n      config.maxAttacks\n    );\n  }\n  sendPossibleCardsToUser(possibleCards) {\n    if (!possibleCards) possibleCards = this.findPossibleCards(this.userIndex);\n    this.observable.update([{prop: 'possibleCards', value: possibleCards}]);\n  }\n  findPossibleCards(playerIndex) {\n    if (playerIndex === this.defender) return this.findCardsForDefend(playerIndex);\n    else return this.findCardsForAttack(playerIndex);\n  }\n  findCardsForAttack(playerIndex) {\n    const attacks = this.cards.table;\n    const playerCards = this.cards.players[playerIndex];\n    if (attacks.length >= this.maxAttacks) return [];\n    if (!attacks.length) return playerCards.map(card => card.id);\n\n    const tableCards = [];\n    for (const attack of attacks) {\n      tableCards.push(...attack);\n    }\n    const tableCardRanks = tableCards.map(card => card.rank);\n    return playerCards.filter(card => tableCardRanks.includes(card.rank))\n                      .map(card => card.id);\n  }\n  findCardsForDefend(playerIndex) {\n    const playerCards = this.cards.players[playerIndex];\n    const notBeatenAttacks = this.cards.table\n      .map((attack, index) => ({cards: attack, index}))\n      .filter(attack => {\n        if (attack.cards.length === 1) return true;\n        return false;\n      });\n    const possibleCards = [];\n    for (const attack of notBeatenAttacks) {\n      const attackCard = attack.cards[0];\n      playerCards.filter(card =>\n        this.getHigherCard(card, attackCard).id === card.id\n      ).forEach(card => {\n        if (!possibleCards.includes(card.id)) possibleCards.push(card.id);\n      });\n    }\n    return possibleCards;\n  }\n  makeDecision(playerIndex) {\n    const possibleCards = this.findPossibleCards(playerIndex);\n    if (possibleCards.length) {\n      const isDefender = this.defender === playerIndex;\n      const isAttackRequired = !this.cards.table.length;\n      const cardsInDeck = !!this.cards.deck.length;\n      const unbeatenCards = this.cards.table.filter(attack => attack.length === 1);\n      const cardId = possibleCards[0];\n      const card = this.getCardById(cardId);\n      let pass = false;\n\n      if (!isDefender) {\n        if (!isAttackRequired) {\n          if (cardsInDeck && card.suit === this.trumpSuit) pass = true;\n        }\n      } else {\n        if (possibleCards.length < unbeatenCards.length) pass = true;\n        if (cardsInDeck && card.suit === this.trumpSuit && card.value > 10) pass = true;\n      }\n\n      if (!pass) return cardId;\n      else return null;\n    } \n  }\n  makeMove(playerIndex, cardId) {\n    const isDefender = playerIndex === this.defender;\n    const card = this.getCardById(cardId);\n\n    const tableCards = this.addCardToTable(card, isDefender);\n\n    const playerCards = this.cards.players.map((cards, index) => {\n      if (index === playerIndex) {\n        return cards.filter(playerCard => playerCard.id !== cardId);\n      } else return cards;\n    });\n\n    this.cards = {\n      ...this.cards,\n      table: tableCards,\n      players: playerCards\n    };\n    this.observable.update([{ prop: 'cards', value: this.cards }]);\n  }\n  addCardToTable(card, defendCard) {\n    const tableCards = helpers.getDeepCopy(this.cards.table);\n    if (defendCard) {\n      let attackIndexes = [];\n      tableCards.forEach((attack, index) => {\n        if (attack.length === 1 &&\n            this.getHigherCard(card, attack[0]).id === card.id) {\n              attackIndexes.push(index);\n        }\n      });\n      const randomIndex = Math.floor(Math.random() * attackIndexes.length);\n      const attackIndex = attackIndexes[randomIndex];\n      return tableCards.map((attack, index) =>\n        index === attackIndex ? ([ ...attack, card ]) : attack\n      );\n    } \n    \n    return [ ...this.cards.table, [ card] ];\n  }\n  getCardById(id) {\n    for (const place in this.cards) {\n      for (const elem of this.cards[place]) {\n        if (elem instanceof Array) {\n          for (const card of elem) {\n            if (card.id === id) return card;\n          }\n        } else {\n          if (elem.id === id) return elem;\n        }\n      }\n    }\n  }\n  getHigherCard(a, b) {\n    if (a.suit === b.suit) {\n      if (a.value > b.value) return a;\n      else return b;\n    }\n    if (a.suit === this.trumpSuit) return a;\n    return b;\n  }\n  updateActivePlayerTimers() {\n    const isUserInGame = this.activePlayers.isPlayerInGame(this.userIndex);\n    let userHasNoPossibleCards = isUserInGame ? false : true;\n    for (const playerObject of this.activePlayers.players) {\n      if (playerObject.index === this.userIndex) {\n        if (playerObject.pass) userHasNoPossibleCards = true;\n        else {\n          const possibleCards = this.findPossibleCards(playerObject.index);\n          if (!possibleCards.length) userHasNoPossibleCards = true;\n          this.sendPossibleCardsToUser(possibleCards);\n        }\n      } else if (!playerObject.timer) {\n        const possibleCards = this.findPossibleCards(playerObject.index)\n          .filter(cardId => \n            !playerObject.rejected.includes(cardId));\n        \n        if (possibleCards.length) {\n          const randomTime = isUserInGame ? \n            Math.random() * 2000 + 2000 :\n            Math.random() * 1500 + 1500;\n          \n          playerObject.timer = setTimeout(\n            () => {\n              playerObject.timer = null;\n              const decision = this.makeDecision(playerObject.index);\n              if (decision) this.makeMove(playerObject.index, decision);\n              else playerObject.rejected.push(...possibleCards);\n\n              this.updateActivePlayerTimers();\n            }, randomTime);\n        }\n      }\n    }\n    if (this.activePlayers.playersDontHaveTimers() && userHasNoPossibleCards) {\n      this.endTrick();\n    }\n  }\n  endTrick() {\n    this.defendSucceed = this.cards.table.reduce((bool, attack) =>\n      attack.length === 1 ? false : bool, true);\n\n    this.clearTable();\n    this.drawCardsFromDeck();\n  }\n  clearTable() {\n    const playerCards = helpers.getDeepCopy(this.cards.players[this.defender]);\n    const discardedCards = helpers.getDeepCopy(this.cards.discarded);\n    for (const attack of this.cards.table) {\n      for (const card of attack) {\n        if (this.defendSucceed) discardedCards.push(card);\n        else playerCards.push(card);\n      }\n    }\n    this.cards = {\n      ...this.cards,\n      players: this.cards.players.map((cards, index) =>\n        index === this.defender ? playerCards : cards),\n      discarded: discardedCards,\n      table: []\n    };\n    this.sortPlayerCards();\n    this.observable.update([{ prop: 'cards', value: this.cards }]);\n  }\n  drawCardsFromDeck() {\n    const playersNumber = this.cards.players.length;\n    let playersDrawnCards = 0;\n    let index = this.attacker;\n    const changePlayers = (index, newCards) =>\n      this.cards.players.map((cards, i) => index === i ? newCards : cards);\n\n    while(playersDrawnCards < playersNumber) {\n      const playerHasCards = this.cards.players[index].length;\n      if (playerHasCards < config.maxCardsAfterDealing) {\n        const cardsNeeded = config.maxCardsAfterDealing - playerHasCards;\n        const playerCards = helpers.getDeepCopy(this.cards.players[index]);\n        const deckCards = helpers.getDeepCopy(this.cards.deck);\n\n        for (let i = 0; i < cardsNeeded; i++) {\n          if (deckCards.length) {\n            const lastDeckCard = deckCards.pop();\n            playerCards.push(lastDeckCard);\n          }\n        }\n\n        this.cards = {\n          ...this.cards,\n          players: changePlayers(index, playerCards),\n          deck: deckCards\n        };\n      }\n\n      this.sortPlayerCards();\n      this.observable.update([{ prop: 'cards', value: this.cards }]);\n      playersDrawnCards++;\n      index = index - 1;\n      if (index === -1) index = playersNumber - 1;\n    }\n  }\n  endGame() {\n    let loser = null;\n    for (const [playerIndex, cards] of this.cards.players.entries()) {\n      if (cards.length) {\n        loser = playerIndex;\n        break;\n      }\n    }\n    this.trumpSuit = null;\n    this.cards = {\n      deck: [],\n      players: [],\n      table: [],\n      discarded: []\n    };\n    this.observable.update([\n      { prop: 'isPlaying', value: false },\n      { prop: 'trumpSuit', value: null },\n      { prop: 'attacker', value: null },\n      { prop: 'defender', value: null },\n      { prop: 'loser', value: loser }\n    ]);\n  }\n  makeUserMove(cardId) {\n    const possibleCards = this.findPossibleCards(this.userIndex);\n    if (possibleCards.includes(cardId)) {\n      this.makeMove(this.userIndex, cardId);\n      this.updateActivePlayerTimers();\n    }\n  }\n  pass() {\n    this.activePlayers.userPass();\n    this.observable.update([{prop: 'possibleCards', value: []}])\n    this.updateActivePlayerTimers();\n  }\n};\n\nexport default GameState;","export default {\n  functions: [],\n  delaying: false,\n  add(fn) {\n    this.functions.push(fn);\n    this.run();\n  },\n  run() {\n    if (this.functions.length && !this.delaying) {\n      const fn = this.functions[0];\n      this.delaying = true;\n      setTimeout(() => {\n        fn();\n        this.functions.shift();\n        this.delaying = false;\n        this.run();\n      }, 200);\n    }\n  }\n};\n","import React, {Component} from 'react';\nimport websocket from '../websocket';\nimport AppContext from '../context/AppContext';\nimport Menu from './Menu';\nimport WaitPage from './WaitPage';\nimport Table from './Table';\nimport Cards from './Cards';\nimport PassButton from './PassButton';\nimport Arrow from './Arrow';\nimport Timer from './Timer';\nimport Filters from './Filters';\nimport GameState from '../lib/GameState';\nimport delayedFunctions from '../lib/delayed-functions';\nimport * as helpers from '../lib/helpers';\nimport '../stylesheets/App.css';\n\nclass App extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.state = {\n\t\t\tviewport: {\n\t\t\t\twidth: 1024,\n\t\t\t\theight: 768\n\t\t\t},\n\t\t\tisPlaying: false,\n\t\t\tisWaiting: false,\n\t\t\tuserIndex: 0,\n\t\t\tusername: '',\n\t\t\tmode: 'single-player',\n\t\t\tplayersNumber: 2,\n\t\t\tplayers: [],\n\t\t\tcards: {\n\t\t\t\tdeck: [],\n\t\t\t\tplayers: [],\n\t\t\t\ttable: [],\n\t\t\t\tdiscarded: []\n\t\t\t},\n\t\t\tpossibleCards: [],\n\t\t\tattacker: null,\n\t\t\tdefender: null,\n\t\t\ttrumpSuit: null,\n\t\t\tloser: null,\n\t\t\tshowButton: false,\n\t\t\tmovedCard: null,\n\t\t\ttimer: null\n\t\t};\n\n\t\tthis.timeout = null;\n\t\tthis.gameState = null;\n\t\tthis.cardStyles = null;\n\t\tthis.handleStateUpdate = this.handleStateUpdate.bind(this);\n\t\tthis.updateViewport = this.updateViewport.bind(this);\n\t\tthis.startGame = this.startGame.bind(this);\n\t\tthis.makeMove = this.makeMove.bind(this);\n\t\tthis.pass = this.pass.bind(this);\n\t\tthis.updateCardStyles = this.updateCardStyles.bind(this);\n\t\tthis.addMovedCard = this.addMovedCard.bind(this);\n\t\tthis.removeMovedCard = this.removeMovedCard.bind(this);\n\t\tthis.changeName = this.changeName.bind(this);\n\t\tthis.changeMode = this.changeMode.bind(this);\n\t\tthis.changePlayersNumber = this.changePlayersNumber.bind(this);\n\t\tthis.saveUserSettings = this.saveUserSettings.bind(this);\n\t\tthis.waitUsers = this.waitUsers.bind(this);\n\t\tthis.cancelWaiting = this.cancelWaiting.bind(this);\n\t\tthis.startMultiplayGame = this.startMultiplayGame.bind(this);\n\t\tthis.reduceTimer = this.reduceTimer.bind(this);\n\t}\n\n\tgetUserSettings() {\n\t\tconst settingsString = localStorage.getItem('settings');\n\t\tif (settingsString) {\n\t\t\tconst settings = JSON.parse(settingsString);\n\t\t\tconst { username, mode, playersNumber } = settings;\n\t\t\tthis.setState({ username, mode, playersNumber });\n\t\t}\n\t}\n\n\tsaveUserSettings() {\n\t\tconst { username, mode, playersNumber } = this.state;\n\t\tconst settingsString = JSON.stringify({ username, mode, playersNumber });\n\t\tlocalStorage.setItem('settings', settingsString);\n\t}\n\n\tchangeName(name) {\n\t\tthis.setState({ username: name });\n\t}\n\n\tchangeMode(mode) {\n\t\tthis.setState({ mode });\n\t}\n\n\tchangePlayersNumber(number) {\n\t\tthis.setState({ playersNumber: number });\n\t}\n\n\twaitUsers() {\n\t\tthis.setState({ isWaiting: true });\n\t}\n\n\tcancelWaiting() {\n\t\tthis.setState({ isWaiting: false });\n\t}\n\n\tstartMultiplayGame() {\n\t\tthis.setState({ isWaiting: false, isPlaying: true });\n\t\twebsocket.listen((type, msgObj) => {\n\t\t\tif (type === 'message' && msgObj.type === 'gameStateUpdate') {\n\t\t\t\tdelayedFunctions.add(() => this.handleStateUpdate(msgObj.data.updates));\n\t\t\t}\n\t\t});\n\t}\n\n\taddObserver() {\n\t\treturn this.gameState.observable.subscribe(updates => {\n\t\t\tdelayedFunctions.add(() => this.handleStateUpdate(updates));\n\t\t});\n\t}\n\n\tupdateCardStyles(cardId, style) {\n\t\tthis.cardStyles = {\n\t\t\t...this.cardStyles,\n\t\t\t[cardId]: style\n\t\t};\n\t}\n\n\tupdateViewport() {\n\t\tconst html = document.documentElement;\n\t\tconst width = html.clientWidth;\n\t\tconst height = html.clientHeight;\n\t\tthis.setState({\n\t\t\tviewport: { width, height }\n\t\t});\n\t}\n\n\taddResizeListener() {\n\t\tlet throttled = false;\n\t\tconst fn = () => {\n\t\t\tif (!throttled) {\n\t\t\t\tthrottled = true;\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tthrottled = false;\n\t\t\t\t\tthis.updateViewport();\n\t\t\t\t}, 300);\n\t\t\t}\n\t\t};\n\t\twindow.addEventListener('resize', fn);\n\t\treturn () => window.removeEventListener('resize', fn);\n\t}\n\n\tgenPlayers(playersNumber) {\n\t\tconst players = Array.from(\n\t\t\t{ length: playersNumber },\n\t\t\t(_, i) => ({ name: 'Player' + i })\n\t\t);\n\t\treturn players;\n\t}\n\n\thandleStateUpdate(updates) {\n\t\tconst updateObject = {};\n\t\tfor (let { prop, value } of updates) {\n\t\t\tupdateObject[prop] = value;\n\t\t}\n\n\t\tthis.setState(updateObject);\n\t}\n\n\taddMovedCard(cardId) {\n\t\tthis.setState({movedCard: cardId});\n\t}\n\n\tremoveMovedCard() {\n\t\tthis.setState({movedCard: null});\n\t}\n\n\tstartGame() {\n\t\tconst { playersNumber } = this.state;\n\t\tthis.gameState = new GameState();\n\t\tthis.unsubscribe = this.addObserver();\n\t\tthis.setState({ \n\t\t\tisPlaying: true,\n\t\t\tplayers: this.genPlayers(playersNumber)\n\t\t});\n\n\t\tthis.gameState.initNewGame(playersNumber);\n\t\tthis.gameState.startGame();\n\t}\n\n\tmakeMove(cardId) {\n\t\tif (this.state.mode === 'single-player') {\n\t\t\tthis.gameState.makeUserMove(cardId);\n\t\t} else {\n\t\t\twebsocket.send({ type: 'move', data: { cardId } });\n\t\t}\n\t}\n\n\tpass() {\n\t\tif (this.state.mode === 'single-player') {\n\t\t\tthis.gameState.pass();\n\t\t} else {\n\t\t\twebsocket.send({ type: 'pass' });\n\t\t}\n\t}\n\n\tskip() {\n\t\twebsocket.send({ type: 'skip' });\n\t}\n\n\thandleStartTrick(prevState) {\n\t\tif (this.state.mode === 'multiplayer') return;\n\t\tconst prevAttacks = prevState.cards.table;\n\t\tconst currAttacks = this.state.cards.table;\n\t\tconst prevTrump = prevState.trumpSuit;\n\t\tconst currTrump = this.state.trumpSuit;\n\t\tconst tableGetEmpty = !!prevAttacks.length && !currAttacks.length;\n\t\tconst trumpHasChosen = !prevTrump && currTrump;\n\t\tif (tableGetEmpty || trumpHasChosen) this.gameState.startTrick();\n\t}\n\n\thandleShowButton(prevState) {\n\t\tconst { possibleCards: prevPossibleCards } = prevState;\n\t\tconst { possibleCards, cards: { table: attacks }, showButton } = this.state;\n\t\tif (possibleCards.length && attacks.length) {\n\t\t\tif (prevPossibleCards.length !== possibleCards.length && !showButton) {\n\t\t\t\tthis.setState({ showButton: true });\n\t\t\t}\n\t\t} else if (showButton) this.setState({ showButton: false });\n\t}\n\n\thandleEndGame(prevState) {\n\t\tif (prevState.isPlaying && !this.state.isPlaying) {\n\t\t\tif (this.state.mode === 'multiplayer') {\n\t\t\t\twebsocket.close();\n\t\t\t} else {\n\t\t\t\tthis.gameState = null;\n\t\t\t\tthis.unsubscribe();\n\t\t\t}\n\t\t}\n\t}\n\n\treduceTimer() {\n\t\tconst { timer } = this.state;\n\t\tthis.setState({timer: timer - 1 });\n\t\tif (timer === 1) this.skip();\n\t\telse this.timeout = setTimeout(this.reduceTimer, 1000);\n\t}\n\n\thandleTimerUpdate(prevState) {\n\t\tif (this.state.mode === 'multiplayer') {\n\t\t\tif (prevState.possibleCards.length !== this.state.possibleCards.length) {\n\t\t\t\tif (this.state.possibleCards.length) {\n\t\t\t\t\tthis.setState({timer: 10});\n\t\t\t\t\tif (this.timeout) clearTimeout(this.timeout);\n\t\t\t\t\tthis.timeout = setTimeout(this.reduceTimer, 1000);\n\t\t\t\t} else {\n\t\t\t\t\tthis.setState({timer: null});\n\t\t\t\t\tif (this.timeout) clearTimeout(this.timeout);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.updateViewport();\n\t\tthis.getUserSettings();\n\t\tthis.removeListener = this.addResizeListener();\n\t}\n\n\tcomponentDidUpdate(_, prevState) {\n\t\tthis.handleStartTrick(prevState);\n\t\tthis.handleShowButton(prevState);\n\t\tthis.handleEndGame(prevState);\n\t\tthis.handleTimerUpdate(prevState);\n\t}\n\n\tcomponentWillUnmount() {\n\t\tif (this.removeListener) this.removeListener();\n\t\tif (this.unsubscribe) this.unsubscribe();\n\t}\n\n\trender() {\n\t\tconst field = helpers.getFieldProps(this.state.viewport);\n\t\treturn (\n\t\t\t<AppContext.Provider value={{\n\t\t\t\tlang: this.props.lang,\n\t\t\t\tcardStyles: this.cardStyles, \n\t\t\t\tpossibleCards: this.state.possibleCards, \n\t\t\t\ttrumpSuit: this.state.trumpSuit, \n\t\t\t\tmovedCard: this.state.movedCard,\n\t\t\t\tupdateCardStyles: this.updateCardStyles, \n\t\t\t\tmakeMove: this.makeMove,\n\t\t\t\taddMovedCard: this.addMovedCard,\n\t\t\t\tremoveMovedCard: this.removeMovedCard\n\t\t\t}}>\n\t\t\t\t<Menu \n\t\t\t\t\tisPlaying={this.state.isPlaying}\n\t\t\t\t\tusername={this.state.username}\n\t\t\t\t\tmode={this.state.mode} \n\t\t\t\t\tplayersNumber={this.state.playersNumber} \n\t\t\t\t\tchangeName={this.changeName}\n\t\t\t\t\tchangeMode={this.changeMode} \n\t\t\t\t\tchangePlayersNumber={this.changePlayersNumber}\n\t\t\t\t\tstartGame={this.startGame}\n\t\t\t\t\twaitUsers={this.waitUsers}\n\t\t\t\t\tsaveUserSettings={this.saveUserSettings}\n\t\t\t\t/>\n\t\t\t\t<WaitPage \n\t\t\t\t\tusername={this.state.username} \n\t\t\t\t\tplayersNumber={this.state.playersNumber} \n\t\t\t\t\tisPlaying={this.state.isPlaying}\n\t\t\t\t\tisWaiting={this.state.isWaiting}\n\t\t\t\t\tcancelWaiting={this.cancelWaiting}\n\t\t\t\t\tstartMultiplayGame={this.startMultiplayGame}\n\t\t\t\t/>\n\t\t\t\t<svg className=\"app\" >\n\t\t\t\t\t<g className=\"field\" width={field.width} height={field.height} style={field.style}>\n\t\t\t\t\t\t<Table field={field} />\n\t\t\t\t\t\t<Cards \n\t\t\t\t\t\t\tcards={this.state.cards} \n\t\t\t\t\t\t\tfield={field} \n\t\t\t\t\t\t\tplayers={this.state.players} \n\t\t\t\t\t\t\tuserIndex={this.state.userIndex}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<PassButton\n\t\t\t\t\t\t\tshow={this.state.showButton}\n\t\t\t\t\t\t\ttext={this.state.defender === this.state.userIndex ? \n\t\t\t\t\t\t\t\tthis.props.lang === 'ru' ? 'Взять' : 'Pick up' : \n\t\t\t\t\t\t\t\tthis.props.lang === 'ru' ? 'Пас' : 'Pass'}\n\t\t\t\t\t\t\tonClick={this.state.showButton ? this.pass : null}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Arrow \n\t\t\t\t\t\t\tfield={field}\n\t\t\t\t\t\t\tdefenderIndex={this.state.defender} \n\t\t\t\t\t\t\tplayersCount={this.state.players.length} \n\t\t\t\t\t\t\tuserIndex={this.state.userIndex}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Timer timer={this.state.timer} />\n\t\t\t\t\t</g>\n\t\t\t\t\t<Filters />\n\t\t\t\t</svg>\n\t\t\t</AppContext.Provider>\n\t\t);\n\t}\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './components/App';\nimport './stylesheets/index.css';\nimport * as serviceWorker from './serviceWorker';\n\nconst lang = window.location.pathname === '/ru' ? 'ru' : 'en';\nif (lang === 'ru') document.title = 'Дурак';\n\nReactDOM.render(\n  <App lang={lang} />,\n  document.getElementById('root')\n);\n\nserviceWorker.unregister();\n"],"sourceRoot":""}